import{d as ue,e as t,j as W,l as F,v as pe,r as me,x as ce,o as k,c as S,a as o,w as c,g as s,q as f,h as V,u as r,n as w,t as M,m as ve,y as X,F as Z,z as fe,A as we,B as ee,p as C}from"./index-pnATmtku.js";import{a as j}from"./axios-BimPEqV4.js";import{u as ye}from"./theme-BUTl8j4H.js";import{_ as be}from"./MainWrapperView.vue_vue_type_style_index_0_lang-yKR37UIB.js";import{_ as U}from"./ButtonView.vue_vue_type_style_index_0_computed_true_lang-BVf0feqf.js";import{_ as P}from"./InputView.vue_vue_type_style_index_0_lang-DhlMFPc5.js";import{_ as ae}from"./ModalEditorView.vue_vue_type_style_index_0_lang-hiiICN91.js";import{m as he}from"./formValidator-OdL4bhgE.js";import{l as ge}from"./index-NsU1tN7b.js";const xe={style:{display:"flex","flex-flow":"row nowrap","justify-content":"flex-end","margin-bottom":"1rem"}},Ve={class:"profile-wrap"},Ce={style:{fontSize:"28px"}},Pe={style:{"text-transform":"capitalize"}},_e={style:{"text-transform":"uppercase"}},ke={class:"row"},Se={class:"col-md-12",style:{"margin-top":"1rem","border-top":"1px solid #ccc","padding-top":"1rem"}},Ue={class:"response"},Ie=ue({__name:"MeView",setup(Ee){const{vFullname:O,vEmail:Y,vPhone:H,checkValidation:$,vPassword:L,vIsEqual:R,vIsNotEqual:G}=he(),l=ye(),B=t(!0),J=t(!0),i=t(""),u=t(""),K=t(""),v=t(""),E=t(""),N=t(""),A=t(""),Q=[E,N,A];E.value=Y(u).message,A.value=H(v).message,N.value=O(i).message,B.value=$(Q);const y=t(!1),b=t(!1),I=async()=>{try{const e=(await j.post(C.baseEnd+"api/user/userdata",{},{headers:C.headerSet})).data.payload;i.value=e.profile.fullname,u.value=e.email,K.value=e.level,v.value=e.profile.phone}catch(n){console.log(n)}};W(()=>{I()}),F([i,u,v],()=>{E.value=Y(u).message||"",A.value=H(v).message||"",N.value=O(i).message||"",B.value=$(Q)},{immediate:!0});const te=()=>{y.value=!y.value},se=()=>{b.value=!b.value},le=async()=>{y.value=!y.value;const n={username:u.value,phone:v.value,email:u.value,fullname:i.value};try{const m=(await j.post(C.baseEnd+"api/user/userdata/update",n,{headers:C.headerSet})).data;l.notifyAlertSuccess("Updated",m.message,"Ok",()=>{I()})}catch(e){l.notifyAlertError("Failure",e+"","Close",()=>{I()})}},h=t(""),d=t(""),g=t(""),T=t(""),q=t(""),z=t(""),oe=[T,q,z];T.value=L(d).message,q.value=R(d,g,"Password confirmation mismatched").message,z.value=G(d,h,"New password cannot be same as current password").message,F([d,h,g],()=>{T.value=L(d).message,q.value=R(d,g,"Password confirmation mismatched").message,z.value=G(d,h,"New password cannot be same as current password").message,J.value=$(oe)},{immediate:!0});const ne=async()=>{const n={current_password:h.value,new_password:d.value,new_password_confirmation:g.value};try{const e=await j.post(C.baseEnd+"api/user/userdata/update_password",n,{headers:C.headerSet});l.notifyAlertSuccess("Update Password",e.data.message,"Okay",()=>{}),b.value=!1}catch(e){l.notifyAlertError("Update Password",e.response.data.message,"Okay",()=>{}),b.value=!1}},p=t(null),x=t(""),_=t([]);W(()=>{p.value||(p.value=ge("http://localhost:3000"),p.value.on("connect",()=>{l.notifyShow("Connected to AI")}),p.value.on("disconnect",()=>{l.notifyShow("AI Disconnected")}),p.value.on("message",n=>{const e=n.choices;for(let m=0;m<e.length;m++)_.value.push({content:e[m].message.content,type:"ai"})}))});const re=()=>{x.value!=null&&(_.value.push({content:x.value,type:"user"}),p.value!=null&&p.value.emit("sendPrompt",x.value),x.value="")};pe(()=>{var n;(n=p.value)==null||n.close()});const D=t(null);return F(_,()=>{D.value&&(D.value.scrollTop=D.value.scrollHeight)}),(n,e)=>{const m=me("font-awesome-icon"),ie=ce("id");return k(),S(Z,null,[o(be,{"context-title":"Profile: "+i.value,"context-desc":"You can update or just view Your profile here"},{default:c(()=>[s("div",xe,[o(U,{"bt-size":"normal",onClick:se,"bt-disabled":!1},{default:c(()=>[o(m,{icon:"lock"}),e[9]||(e[9]=f(" Change Password"))]),_:1})]),s("div",Ve,[s("img",{style:V({border:`5px solid ${r(l).accentColor}`,borderRadius:"200px"}),src:"https://avatar.iran.liara.run/public/boy?username=Ash"},null,4),i.value?(k(),S("div",{key:0,class:w(["profile-data",r(l).textTheme]),style:{"text-align":"center","margin-top":"1rem"}},[s("span",Ce,[s("b",Pe,M(i.value),1)]),s("code",{style:V({color:r(l).accentColor,fontSize:"13px"})},[f(M(u.value)+" Â· ",1),s("b",_e,M(K.value),1)],4),o(U,{onClick:te,style:{"margin-top":"1rem"},"bt-type":"button","bt-disabled":!1},{default:c(()=>[o(m,{icon:"edit"}),e[10]||(e[10]=f(" Edit"))]),_:1})],2)):ve("",!0)]),s("div",ke,[s("div",Se,[s("div",Ue,[s("h4",{style:{"text-align":"center"},class:w(r(l).textTheme)},e[11]||(e[11]=[s("b",null,"Chandra AI",-1)]),2),X((k(),S("div",{class:w(["chat-container",r(l).mTheme])},[s("p",{class:w(r(l).textTheme),style:{"text-align":"center"}},[e[12]||(e[12]=f(" Send prompt to start chatting ")),e[13]||(e[13]=s("br",null,null,-1)),s("code",{style:V({color:r(l).accentColor})},"powered by llama",4)],2),s("div",{class:"messages",ref_key:"chatContainer",ref:D},[(k(!0),S(Z,null,fe(_.value,(a,de)=>(k(),S("div",{key:de,class:w(["message"])},[s("div",{class:w(["balloon"]),style:V({background:a.type==="ai"?r(l).accentColor:r(l).accentColorSecondary})},[s("span",{style:V([{textAlign:a.type==="ai"?"left":"right"},{display:"block",color:"#fff"}])},M(a.content),5)],4)]))),128))],512)],2)),[[ie,_.value.length]])]),X(s("textarea",{"onUpdate:modelValue":e[0]||(e[0]=a=>x.value=a),class:w(r(l).mTheme),placeholder:"Type something...",style:V([{display:"block",width:"100%",height:"100px",padding:"10px","margin-top":"1rem"},{color:r(l).accentColor,border:`1px solid ${r(l).accentColor}`}]),spellcheck:"false"},null,6),[[we,x.value]]),o(U,{onClick:re,"bt-disabled":!1,"bt-type":"button",style:{"margin-top":"1rem"}},{default:c(()=>e[14]||(e[14]=[f("Send")])),_:1})])])]),_:1},8,["context-title"]),o(ae,{"mod-title":"Change Password","mod-show":b.value,"onUpdate:modShow":e[4]||(e[4]=a=>b.value=a)},{default:c(()=>[s("form",{onSubmit:ee(ne,["prevent"])},[o(P,{modelValue:h.value,"onUpdate:modelValue":e[1]||(e[1]=a=>h.value=a),"in-required":!0,"in-type":"password","in-label":"Current Password","in-helper":z.value},null,8,["modelValue","in-helper"]),o(P,{modelValue:d.value,"onUpdate:modelValue":e[2]||(e[2]=a=>d.value=a),"in-required":!0,"in-type":"password","in-helper":T.value,"in-label":"New Password"},null,8,["modelValue","in-helper"]),o(P,{modelValue:g.value,"onUpdate:modelValue":e[3]||(e[3]=a=>g.value=a),"in-required":!0,"in-type":"password","in-label":"Confirm New Password","in-helper":q.value},null,8,["modelValue","in-helper"]),o(U,{"bt-type":"submit","bt-disabled":J.value},{default:c(()=>e[15]||(e[15]=[f("Update")])),_:1},8,["bt-disabled"])],32)]),_:1},8,["mod-show"]),o(ae,{"mod-title":"Update Profile","mod-show":y.value,"onUpdate:modShow":e[8]||(e[8]=a=>y.value=a)},{default:c(()=>[s("form",{onSubmit:ee(le,["prevent"])},[o(P,{"in-helper":N.value,"in-required":!0,modelValue:i.value,"onUpdate:modelValue":e[5]||(e[5]=a=>i.value=a),"in-type":"text","in-label":"Name"},null,8,["in-helper","modelValue"]),o(P,{"in-helper":E.value,"in-required":!0,modelValue:u.value,"onUpdate:modelValue":e[6]||(e[6]=a=>u.value=a),"in-type":"text","in-label":"E-Mail"},null,8,["in-helper","modelValue"]),o(P,{"in-helper":A.value,"in-required":!0,modelValue:v.value,"onUpdate:modelValue":e[7]||(e[7]=a=>v.value=a),"in-type":"text","in-label":"Phone"},null,8,["in-helper","modelValue"]),o(U,{"bt-type":"submit","bt-disabled":B.value},{default:c(()=>e[16]||(e[16]=[f("Update")])),_:1},8,["bt-disabled"])],32)]),_:1},8,["mod-show"])],64)}}});export{Ie as default};
