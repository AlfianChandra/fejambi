import{u as mt}from"./theme-g-j4RzVu.js";import{_ as zt}from"./MainWrapperView.vue_vue_type_style_index_0_lang-BkdLZbwd.js";import{_ as De}from"./SelectView.vue_vue_type_style_index_0_lang-yJLv2oEB.js";import{_ as ke}from"./InputView.vue_vue_type_style_index_0_lang-2YIYBEL6.js";import{_ as M}from"./ButtonView.vue_vue_type_style_index_0_computed_true_lang-Bz-6-Op8.js";import{t as nt}from"./trunk-CuaAdnZJ.js";import{d as Ze,e as r,C as At,j as it,G as Je,r as Xe,o as s,c as n,a as i,w,f as re,m as S,g as t,t as g,_ as rt,i as bt,l as A,q as c,n as Z,u as x,y as Ae,D as Ye,h as Y,F as O,z as j,p as Yt}from"./index-D1adL8BK.js";import{a as Qe}from"./axios-BimPEqV4.js";import{i as yt}from"./index-CehbAW_K.js";import{h as q}from"./moment-C5S46NFB.js";import{a as Rt,m as jt,_ as It,u as Ut}from"./HistoryECharts.vue_vue_type_script_setup_true_lang-CJtd_E0E.js";const qt={style:{width:"100%",display:"flex","flex-flow":"column"}},Bt=Ze({__name:"PressureDistView",props:{selectedSpot:{type:String,required:!0},data:{type:Object,required:!0},leakPointResult:Object},setup(Se){const ee=r(!1),B=Se,W=At(()=>B.data),z=r(nt().getAllTrunk()),b=r({}),F=r(B.selectedSpot),_=()=>z.value[F.value].trunkLength,L=r(0),I=G=>{L.value=G};return it(()=>{ee.value=!0,b.value=W.value,ee.value=!1}),Je(()=>{ee.value=!0,b.value=W.value,ee.value=!1}),(G,v)=>{const ae=Xe("center");return s(),n("div",qt,[i(ae,null,{default:w(()=>[i(ke,{"in-label":"Drop Tolerance Value","in-type":"number","model-value":L.value,"onUpdate:modelValue":v[0]||(v[0]=p=>L.value=p),style:{width:"200px"}},null,8,["model-value"])]),_:1}),!ee.value&&Object.keys(b.value).length?(s(),re(Rt,{key:0,onOnToleranceChanged:I,"chart-data":b.value,"selected-spot":F.value,"trunk-length":_(),"tolerance-value":L.value,"prediction-result":B.leakPointResult},null,8,["chart-data","selected-spot","trunk-length","tolerance-value","prediction-result"])):S("",!0)])}}}),Kt={class:"loading"},Wt={style:{"margin-left":"10px"}},Gt=Ze({__name:"LoadingView",props:{message:{type:String,default:"Loading..."}},setup(Se){const ee=Se;return(B,W)=>(s(),n("div",Kt,[W[0]||(W[0]=t("img",{src:"https://i.pinimg.com/originals/ee/7a/ce/ee7acee141cf774b5511f8c3cb0e0016.gif",style:{width:"70px",height:"70px","object-fit":"contain"}},null,-1)),t("span",Wt,g(ee.message),1)]))}}),Ht=rt(Gt,[["__scopeId","data-v-c347c2fb"]]),Qt={key:0,class:"datepickdialog"},Jt={class:"datepickinner"},Xt={style:{display:"flex","flex-flow":"row nowrap",gap:"0.2rem"}},Zt={key:1,class:"selfnavdialog"},el={class:"selfnavdialog-inner"},tl={style:{display:"flex","flex-flow":"row nowrap","justify-content":"center","margin-bottom":"1rem",gap:"1rem"}},ll={style:{display:"flex","flex-flow":"row nowrap",gap:"0.5rem","justify-content":"space-between"}},al={style:{display:"flex","flex-flow":"row nowrap",gap:"0.3rem"}},ol={style:{display:"flex","flex-flow":"row nowrap",gap:"0.3rem",height:"45px","align-items":"center"}},sl={style:{"border-radius":"10px",display:"flex","flex-flow":"row nowrap","justify-content":"space-between","padding-left":"10px","padding-right":"10px",border:"1px solid #ccc",padding:"20px","margin-bottom":"1rem"}},nl={style:{border:"1px solid #ccc",padding:"5px","padding-left":"70px","text-align":"center","padding-right":"70px","border-radius":"100px"}},il={key:0,style:{"font-size":"11px"}},rl={key:0,style:{"font-size":"11px"}},ul={key:1,style:{"font-size":"11px"}},dl={style:{display:"flex","flex-flow":"row nowrap",width:"100%","align-items":"center","margin-top":"-40px"}},pl={style:{display:"flex","flex-flow":"no wrap",padding:"10px",gap:"0.5rem"}},cl={style:{width:"100%",padding:"10px",position:"relative"}},vl=["max","value"],fl={key:0,class:"sel-wrapper"},yl={style:{display:"flex","justify-content":"flex-start","overflow-x":"auto","white-space":"nowrap",padding:"20px",gap:"1rem",width:"40%"}},ml=["onClick"],bl={key:0,class:"dataspan"},gl={style:{width:"50%"}},kl={style:{color:"#fff",background:"red",width:"70px",padding:"5px","border-radius":"5px","font-size":"10px","text-align":"center"}},hl={style:{width:"60%","padding-right":"5rem","padding-top":"1rem","padding-bottom":"1rem"}},xl=["src"],wl={class:"table-responsive"},Dl={style:{"margin-top":"1rem"}},Sl={class:"tbl2"},Cl={style:{"margin-top":"1rem"}},$l={class:"tbl2"},Ml={key:0,style:{color:"red","text-shadow":"0.5px 0.5px 1px rgba(0,0,0,0.6)"}},Pl={key:1,style:{color:"orange","text-shadow":"0.5px 0.5px 1px rgba(0,0,0,0.6)"}},Ol={key:2,style:{color:"yellow","text-shadow":"0.5px 0.5px 1px rgba(0,0,0,0.6)"}},_l={key:3,style:{color:"lime","text-shadow":"0.5px 0.5px 1px rgba(0,0,0,0.6)"}},Ll={key:4},Tl={key:2,class:"hmloader"},Vl={key:3,class:"model-window"},Fl={class:"modelpick-inner"},El={key:4,class:"predict-action"},Nl={style:{"margin-bottom":"0.1rem"}},zl={style:{"margin-bottom":"0.5rem"}},Al={style:{display:"flex","flex-flow":"row nowrap",gap:"0.5rem"}},Yl={key:5,class:"leak-window"},Rl={style:{color:"rgb(0,150,255)"}},jl={class:"table-responsive"},Il={style:{width:"100%","margin-top":"1rem"},class:"table table-striped table-hover;"},Ul={key:0,style:{border:"1px solid #ccc",padding:"10px"}},ql={key:1,style:{border:"1px solid #ccc",padding:"10px"}},Bl={style:{"font-weight":"bold",border:"1px solid #ccc",padding:"10px"}},Kl={key:0,style:{"font-weight":"bold",border:"1px solid #ccc",padding:"10px"}},Wl={key:1,style:{"font-weight":"bold",border:"1px solid #ccc",padding:"10px"}},Gl={key:0},Hl=["href"],Ql={style:{"margin-top":"1rem"}},Jl={key:1},Xl={style:{"margin-top":"1rem"}},Zl={key:6,class:"setting-window"},ea={class:"setting-inner"},ta={class:"pref-block"},la={key:7,class:"save-window"},aa={class:"save-inner"},oa={style:{display:"flex","flex-flow":"row nowrap",gap:"0.5rem"}},sa=Ze({__name:"PlaybackViewNew",props:{initDateFilter:{type:String,required:!0},selectedSpot:{type:String,required:!0},initPlaybackDatas:{type:Array,required:!0},snapShots:{type:Object,required:!1,default:null},mainSize:{type:Object,required:!1}},emits:["onDateChange","onDataSave","onLoadPreset","onSnapshotUnloaded"],setup(Se,{emit:ee}){const B=Ut(),W=nt(),z=ee,b=mt(),F=r("forward"),_=r(!1),L=r(""),I=r(!0),G=r(!1),v=Se,ae=r(),p=r(),ue=r(W.getAllTrunk()),T=r(0),ve=r(0),Re=r([]),fe=r(!1),ye=r(250);let H=null;const de=r(!1);let oe=[],he={};const et=r(),Ce=r(""),se=r(""),J=r(!0),X=r(!1),D=r(!1),K=r(!1),xe=r(!1),me=r(!1),Q=r(7),tt=bt();r(tt.params.saveid);let R=r({}),Pe=null;const f=r(null),u=r({}),C=()=>{p.value=yt(ae.value);const a={grid:{top:"10%",left:"10%",right:"10%",bottom:"15%"},legend:{show:!0,type:"scroll",orient:"horizontal"},tooltip:{trigger:"item",triggerOn:"mousemove",axisPointer:{type:"cross",label:{backgroundColor:"#6a7985"}}},axisPointer:{show:!0,type:"shadow"},xAxis:[{type:"category",data:[],boundaryGap:!1,splitNumber:1,minInterval:1,scale:!0,axisLabel:{formatter:function(e){return e.split(" (")[1].split(")")[0]},rotate:45,labelStyle:{fontSize:10}},splitLine:{show:!0,lineStyle:{type:"dashed"}},axisTick:{alignWithLabel:!0}}],yAxis:{type:"value",name:"Pressure (PSI)",nameGap:10,max:600,interval:50,axisTick:{show:!0,inside:!0},splitLine:{show:!0,lineStyle:{type:"solid",color:"#999"}},minorTick:{show:!0},minorSplitLine:{show:!0,lineStyle:{type:"dashed",color:"#ccc"}}},series:[]};p.value.setOption(a),setTimeout(()=>{p.value.dispatchAction({type:"legendInverseSelect"}),p.value.dispatchAction({type:"legendAllSelect"}),p.value.resize()},100)},m=()=>{const a=q().format("YYYY-MM-DD"),e=q(v.initDateFilter).format("YYYY-MM-DD");de.value=a===e};it(()=>{window.addEventListener("keyup",ht),m()}),A(()=>ae.value,()=>{C()});const $=(a,e)=>{oe=[];for(let d of ue.value[v.selectedSpot].spot)he[d.name]=[];v.initPlaybackDatas.slice(0,a+1).forEach((d,y)=>{const N=`${d.dateFilter} (${d.timeRange})`;oe.push(N),et.value=N,d.data.forEach(Ne=>{const We=ue.value[v.selectedSpot].spot.find(He=>He.id===Ne.idSpot).name,Ge=Ne.avgPsiValues??0;he[We][y]=Number(Ge.toFixed(2))})});const k=Object.keys(he).map(d=>({name:d,type:"line",data:he[d],showAllSymbol:me.value,smooth:!1,tooltip:{trigger:"axis",formatter:function(y){return y[0].value}},endLabel:{show:!0,formatter:function(y){return y.value+" ; "+d},color:"#000",backgroundColor:"inherit",padding:5,fontSize:10,borderRadius:5}}));let l=p.value.getOption();l.xAxis[0].data=oe,l.series=k,p.value.setOption(l)},V=()=>{p.value.getOption()},P=()=>{D.value=!1,T.value=0,Re.value=[],clearInterval(H),$(T.value),ve.value=T.value/v.initPlaybackDatas.length*100},pe=a=>{D.value=!1,Re.value=[],T.value=parseInt(a.target.value,10),$(T.value),ve.value=T.value/v.initPlaybackDatas.length*100};A(()=>v.initDateFilter,async()=>{ot(),at(),await Oe().then(()=>{be()})});const be=()=>{const a=q(v.initDateFilter),e=a.add(1,"days").format("YYYY-MM-DD"),o=a.subtract(2,"days").format("YYYY-MM-DD");Ce.value=e,se.value=o};be();const we=async()=>{ot(),await Oe().then(()=>{if(de.value)b.notifyShowError("End of playback");else{K.value=!0,P();const a=q(Ce.value).format("YYYY-MM-DD");X.value&&(D.value=!0),fe.value=!0,z("onDateChange",a),setTimeout(()=>{K.value=!1},5e3)}})},je=async()=>{ot(),await Oe().then(()=>{K.value=!0,P();const a=q(se.value).format("YYYY-MM-DD");X.value&&(D.value=!0),fe.value=!0,z("onDateChange",a),setTimeout(()=>{K.value=!1},5e3)})};A(()=>J.value,()=>{J.value&&(Le(),_.value=!1,X.value=!1)}),A(()=>_.value,()=>{_.value?(J.value=!1,X.value=!0):J.value=!0}),A(()=>X.value,()=>{X.value&&(J.value=!1)}),A(()=>D.value,()=>{if(!D.value&&T.value==v.initPlaybackDatas.length)if(J.value)P(),D.value=!0;else{const a=q().format("YYYY-MM-DD"),e=q(v.initDateFilter).format("YYYY-MM-DD");a===e?D.value=!1:_.value?F.value=="forward"?ne.value?v.initDateFilter!=ie.value?we():Ue.value?(P(),z("onDateChange",ce.value)):Le():we():ne.value?v.initDateFilter!=ce.value?je():Ue.value?(P(),z("onDateChange",ie.value)):Le():je():(P(),D.value=!0)}U.value&&E.value?(ut(),lt(),V()):Ie()});const lt=()=>{if(D.value)Ie();else{const a=p.value.getOption();a.series.forEach(o=>{o.symbolSize=Q.value}),a.series.forEach(o=>{o.symbol="circle"});const e=p.value.getOption().tooltip;e.show=!0,p.value.setOption(a)}},Ie=()=>{const a=p.value.getOption();a.series.forEach(e=>{e.symbolSize=0}),a.series.forEach(e=>{e.symbol="none"}),p.value.setOption(a),p.value.off("click")},h=r({}),ut=()=>{p.value.off("click"),p.value.on("click",a=>{if(a.componentType==="markLine"){if(a.seriesName==="Normal"){b.notifyConfirm("Delete Normal","Are you sure?","Delete","Cancel",async()=>{dt()},()=>{});return}else b.notifyConfirm("Delete Marker","Delete this marker?","Delete","Cancel",async()=>{const d=p.value.getOption();d.series=d.series.filter((y,N)=>N!==a.seriesIndex),p.value.clear(),p.value.setOption(d),Object.keys(h.value).forEach(y=>{h.value[y].index===a.value&&delete h.value[y]}),I.value=!1,setTimeout(()=>{I.value=!0},100)},()=>{});return}const e=oe.findIndex(d=>d===a.name);if(e<0)return;if(h.value.normal){const d=Object.keys(h.value).length,y={type:"line",name:`Drop ${d}`,xAxisIndex:0,data:[],markLine:{symbol:"image://https://gpng.net/wp-content/uploads/ROBBER.png",symbolSize:35,data:[{xAxis:e,symbolRotate:180}],lineStyle:{color:"blue",width:2,type:"dotted"},label:{show:!0,formatter:`Drop ${d}`,position:"insideEndTop"}}},N=p.value.getOption().series;N.push(y),p.value.setOption({series:N})}else{const d={type:"line",name:"Normal",xAxisIndex:0,data:[],markLine:{symbol:"image://https://png.pngtree.com/png-clipart/20230325/original/pngtree-petroleum-workers-or-miners-vector-png-image_9004441.png",symbolSize:42,data:[{xAxis:e}],lineStyle:{color:"red",width:2,type:"dotted"},label:{show:!0,formatter:"Normal",position:"insideEndTop"}}},y=p.value.getOption().series;y.push(d),p.value.setOption({series:y})}const l=p.value.getOption().series.filter(d=>Array.isArray(d.data)).map(d=>({seriesName:d.name,yValue:d.data[e]??0}));if(h.value.normal){const d=Object.keys(h.value).length;h.value[`drop${d}`]={index:e,name:`Drop ${d}`,data:l,order:p.value.getOption().series.length-1,type:"drop",timerange:oe[e].split(" (")[1].split(")")[0],seriesName:oe[e].split(" (")[1].split(")")[0]+".drop."+v.initDateFilter,date:v.initDateFilter}}else{const d={normal:{index:e,name:"Normal",data:l,order:0,type:"normal",timerange:oe[e].split(" (")[1].split(")")[0],seriesName:oe[e].split(" (")[1].split(")")[0]+".normal."+v.initDateFilter,date:v.initDateFilter}};h.value={...d,...h.value},f.value=d.normal.seriesName}})},dt=()=>{const a=p.value.getOption();a.series=a.series.filter(e=>e.name!=="Normal"),p.value.clear(),p.value.setOption(a),delete h.value.normal,b.notifyShow("Normal deleted"),f.value=null},Oe=()=>new Promise((a,e)=>{try{if(Object.keys(h.value).length===0){a();return}const o=p.value.getOption();o.series=o.series.filter(k=>!k.markLine),p.value.clear(),p.value.setOption(o),h.value={},a()}catch(o){e(o)}});A(()=>[D.value,ye.value],()=>{D.value?(H!=null&&clearInterval(H),H=setInterval(()=>{T.value<v.initPlaybackDatas.length?(T.value++,v.initPlaybackDatas[T.value]!=null&&($(T.value),ve.value=T.value/v.initPlaybackDatas.length*100)):(D.value=!1,clearInterval(H))},ye.value)):H&&(clearInterval(H),H=null)}),A(()=>[b.asideVisible],()=>{setTimeout(()=>{p.value.resize()},1e3)});const _e=r(!1),gt=()=>F.value=="forward"?Ce.value:se.value,ge=r(!1),ne=r(!1),Ue=r(!0),ce=r(""),ie=r(""),kt=()=>{ce.value?ie.value?(ne.value=!0,J.value=!1,_.value=!0,X.value=!0,ge.value=!1,D.value=!1):b.notifyShowError("Date 2 is required"):b.notifyShowError("Date 1 is required")};A(()=>ge.value,()=>{ge.value?(D.value=!1,ne.value=!1):D.value=!0}),A(()=>[ne.value],()=>{ne.value&&(P(),F.value=="forward"?z("onDateChange",ce.value):z("onDateChange",ie.value))}),A(()=>F.value,()=>{F.value=="backward"&&(P(),Le())});const Le=()=>{P(),z("onDateChange",v.initDateFilter),ne.value=!1,ce.value=null,ie.value=null},ht=a=>{G.value||((a.keyCode==80||a.keyCode==32)&&(D.value=!D.value),a.keyCode==37&&je(),a.keyCode==39&&we())},xt=(a,e)=>{if(a.type=="normal"){b.notifyConfirm("Delete Normal","Are you sure?","Delete","Cancel",async()=>{dt()},()=>{});return}const o=p.value.getOption();o.series=o.series.filter(k=>k.name!==a.name),p.value.clear(),p.value.setOption(o),delete h.value[e],I.value=!1,setTimeout(()=>{I.value=!0},100)},U=r(null),E=r(null),te=r(!1),Te=r(!1),wt=()=>{Te.value?(te.value=!1,Te.value=!1):(U.value=null,E.value=null,te.value=!1)};A(()=>te.value,()=>{Te.value=!1});const at=()=>{U.value=null,E.value=null,te.value=!1,Ie(),b.notifyShow("Prediction stopped"),Oe(),h.value={},R.value={},v.snapShots!=null&&Object.keys(v.snapShots).length>0&&z("onSnapshotUnloaded")};A(()=>[U.value,E.value],()=>{U.value&&E.value?setTimeout(()=>{ut(),lt()},2e3):Ie()});const Dt=()=>{Te.value=!0,te.value=!0},Ve=r(!1),pt=r([]),le=r([]),$e=r(!1),qe=r(),St=r(),Ct=()=>{if(!U.value||!E.value){b.notifyShowError("Please select model and method");return}b.notifyShow("Prediction started"),te.value=!1;let a={};Object.keys(h.value).forEach(o=>{if(h.value[o].type!=="normal"||h.value[o].type!=="drop"){const k=W.getAllTrunk()[v.selectedSpot].spot.length;let l={name:h.value[o].name,data:h.value[o].data.map(d=>({avgPsiValues:d.yValue})).slice(0,k),type:h.value[o].type};a[h.value[o].name]=l}}),pt.value=[];const e=B.mlpredict(a,E.value,ue.value[v.selectedSpot].name);if(Ve.value=!0,E.value==="dtree_multi"?setTimeout(()=>{le.value=e.sort((o,k)=>o.drop-k.drop)},4e3):E.value==="rf_multi"?setTimeout(()=>{le.value=e.sort((o,k)=>o.drop-k.drop)},4e3):E.value==="rf_single"?setTimeout(()=>{le.value=e.sort((o,k)=>o.drop-k.drop)},4e3):E.value==="eqlr_single"&&setTimeout(()=>{le.value=e.sort((o,k)=>o.drop-k.drop)},4e3),le.value!=null)for(let o=0;o<le.value.length;o++)le.value[o].suspectLocation.leak&&pt.value.push(le.value[o])},ct=r(),vt=r(),$t=(a,e,o)=>{qe.value=a,$e.value=!1,$e.value=!0,ct.value=e,vt.value=o};A(()=>Ve.value,()=>{Ve.value||($e.value=!1,le.value=null,qe.value=null,St.value=null)});const Mt=async a=>{L.value=a,await navigator.clipboard.writeText(L.value),b.notifyShow("Coordinate copied to clipboard")},Be=a=>{const e=Math.floor(a),o=Math.abs(a-e)*60,k=Math.floor(o),l=(o-k)*60;return`${e}° ${k}' ${l.toFixed(2)}"`};A(()=>me.value,()=>{if(me.value){Q.value=5;const a=p.value.getOption();a.series.forEach(e=>{e.showAllSymbol=!0}),a.series.forEach(e=>{e.symbolSize=Q.value}),p.value.setOption(a)}else{Q.value=7;const a=p.value.getOption();a.series.forEach(e=>{e.showAllSymbol=!1}),a.series.forEach(e=>{e.symbolSize=Q.value}),p.value.setOption(a)}}),A(()=>Q.value,()=>{const a=p.value.getOption();a.series.forEach(e=>{e.symbolSize=Q.value}),p.value.setOption(a)});const ot=()=>{Q.value=7,me.value=!1;const a=p.value.getOption();a.series.forEach(e=>{e.symbolSize=Q.value,e.showAllSymbol=!1}),p.value.setOption(a)},Me=r(!1);A(()=>h.value,()=>{R.value={},Object.keys(h.value).forEach(a=>{const e=h.value[a].seriesName,o=h.value[a].data,l=o.map(d=>{const y=W.getAllTrunk()[v.selectedSpot].spot.find(N=>N.name===d.seriesName);if(y!==void 0)return y.id}).filter(d=>d!==void 0);R.value[e]===void 0&&(R.value[e]=[]),l.length>0&&(R.value[e]={date:h.value[a].date,timerange:h.value[a].timerange,type:h.value[a].type,data:l.map((d,y)=>({idSpot:d,avgPsiValues:o[y].yValue}))})})},{deep:!0});const ft=(a,e)=>{const k=R.value[a].data;for(let l=0;l<k.length;l++)if(k[l].idSpot==e)return k[l].avgPsiValues.toFixed(2)};Je(()=>{var a;if(R.value!=null&&(Pe=Object.keys(R.value),f.value!=null)){u.value=[];const e=f.value,o=(a=R.value[e])==null?void 0:a.data;Pe.filter(l=>l!==e).forEach(l=>{const d=R.value[l].data,y=[];ue.value[v.selectedSpot].spot.forEach((N,Ne)=>{const We=N.id,Ge=o.find(ze=>ze.idSpot===We),He=d.find(ze=>ze.idSpot===We);if(Ge&&He){const ze=Ge.avgPsiValues.toFixed(2)-He.avgPsiValues.toFixed(2);y[Ne]=ze}else y[Ne]=0}),u.value.push({dropKey:l,deltas:y})})}});const st=a=>a.spot,Ke=r(!1),Fe=r(""),Ee=r(""),Pt=()=>{D.value=!1,Ke.value=!0,G.value=!0},Ot=()=>{Ke.value=!1,G.value=!1},_t=()=>{if(Fe.value==""||Ee.value==""){b.notifyShowError("Name and description are required");return}b.notifyShow("Saving preset. Please wait..."),Ke.value=!1;const a={name:Fe.value,desc:Ee.value,selectedModel:U.value,selectedMethod:E.value,selections:h.value,seekerValue:T.value};z("onDataSave",a),Fe.value="",Ee.value=""},Lt=()=>{z("onLoadPreset")},Tt=()=>{console.log("Snapshot loaded"),b.notifyShow("Snapshot loaded"),U.value=v.snapShots.selectedModel,E.value=v.snapShots.selectedMethod,setTimeout(()=>{T.value=v.snapShots.seekerValue,setTimeout(()=>{h.value=v.snapShots.selection;const a=p.value.getOption().series;Object.keys(h.value).forEach(o=>{const k=h.value[o];k.type==="normal"?(a.push({type:"line",name:"Normal",xAxisIndex:0,data:[],markLine:{symbol:"image://https://png.pngtree.com/png-clipart/20230325/original/pngtree-petroleum-workers-or-miners-vector-png-image_9004441.png",symbolSize:42,data:[{xAxis:k.index}],lineStyle:{color:"red",width:2,type:"dotted"},label:{show:!0,formatter:"Normal",position:"insideEndTop"}}}),f.value=k.seriesName):a.push({type:"line",name:k.name,xAxisIndex:0,data:[],markLine:{symbol:"image://https://gpng.net/wp-content/uploads/ROBBER.png",symbolSize:35,data:[{xAxis:k.index,symbolRotate:180}],lineStyle:{color:"blue",width:2,type:"dotted"},label:{show:!0,formatter:k.name,position:"insideEndTop"}}})}),p.value.setOption({series:a});const e=p.value.getOption();p.value.clear(),p.value.setOption(e),lt()},1e3),$(T.value)},3e3)};Je(()=>{v.snapShots&&Object.keys(v.snapShots).length>0&&Tt()});const Vt=(a,e)=>{let o=!0;return e.forEach(k=>{a<k&&(o=!1)}),o},Ft=(a,e)=>{let o=0;e.forEach(l=>{o<l&&(o=l)});let k=!0;return e.forEach(l=>{a<l&&l<o&&(k=!1)}),k},Et=(a,e)=>{let o=0;e.forEach(d=>{o<d&&(o=d)});let k=0;e.forEach(d=>{k<d&&d<o&&(k=d)});let l=!0;return e.forEach(d=>{a<d&&d<k&&(l=!1)}),l},Nt=(a,e)=>{let o=!0;return e.forEach(k=>{a>k&&(o=!1)}),o};return Je(()=>{const a={grid:{top:"10%",left:"10%",right:"10%",bottom:"15%"},legend:{show:!0,type:"scroll",orient:"horizontal"},tooltip:{trigger:"item",triggerOn:"mousemove",axisPointer:{type:"cross",label:{backgroundColor:"#6a7985"}}},axisPointer:{show:!0,type:"shadow"},xAxis:[{type:"category",data:[],boundaryGap:!1,splitNumber:1,minInterval:1,scale:!0,axisLabel:{formatter:function(e){return e.split(" (")[1].split(")")[0]},rotate:45,labelStyle:{fontSize:10}},splitLine:{show:!0,lineStyle:{type:"dashed"}},axisTick:{alignWithLabel:!0}}],yAxis:{type:"value",name:"Pressure (PSI)",nameGap:10,max:600,interval:50,axisTick:{show:!0,inside:!0},splitLine:{show:!0,lineStyle:{type:"solid",color:"#999"}},minorTick:{show:!0},minorSplitLine:{show:!0,lineStyle:{type:"dashed",color:"#ccc"}}},series:[]};v.initPlaybackDatas.length>0&&setTimeout(()=>{he={},p.value.dispose(),p.value=yt(ae.value),setTimeout(()=>{p.value.setOption(a),$(T.value),fe.value=!1,X.value&&(D.value=!0)},500)},1e3)}),(a,e)=>{const o=Xe("font-awesome-icon"),k=Xe("center");return s(),n(O,null,[ge.value?(s(),n("div",Qt,[t("div",Jt,[e[31]||(e[31]=t("h2",null,[t("b",null,"Select Range")],-1)),e[32]||(e[32]=t("p",{style:{padding:"0",margin:"0"}},"Automatically plays the playback based on current setup",-1)),i(De,{"in-label":"Speed","model-value":ye.value,"onUpdate:modelValue":e[0]||(e[0]=l=>ye.value=l)},{default:w(()=>e[28]||(e[28]=[t("option",{value:"1000"},"Slowest",-1),t("option",{value:"500"},"Slower",-1),t("option",{value:"300"},"Moderate",-1),t("option",{value:"250"},"Faster",-1),t("option",{value:"200"},"Fastest",-1)])),_:1},8,["model-value"]),i(ke,{"in-type":"date","in-label":"Date 1","model-value":ce.value,"onUpdate:modelValue":e[1]||(e[1]=l=>ce.value=l)},null,8,["model-value"]),i(ke,{"in-type":"date","in-label":"Date 2","model-value":ie.value,"onUpdate:modelValue":e[2]||(e[2]=l=>ie.value=l)},null,8,["model-value"]),t("div",Xt,[i(M,{onClick:kt,"bt-disabled":!1,style:{width:"fit-content"}},{default:w(()=>e[29]||(e[29]=[c("Apply Filter ")])),_:1}),i(M,{onClick:e[3]||(e[3]=l=>ge.value=!ge.value),"bt-disabled":!1,style:{width:"fit-content"}},{default:w(()=>e[30]||(e[30]=[c("Cancel ")])),_:1})])])])):S("",!0),_e.value?(s(),n("div",Zt,[t("div",el,[e[35]||(e[35]=t("h2",null,[t("b",null,"Select Preference")],-1)),i(De,{"in-label":"Select","model-value":F.value,"onUpdate:modelValue":e[4]||(e[4]=l=>F.value=l)},{default:w(()=>e[33]||(e[33]=[t("option",{value:"forward"},"Forward",-1),t("option",{value:"backward"},"Backward",-1)])),_:1},8,["model-value"]),i(M,{onClick:e[5]||(e[5]=l=>_e.value=!_e.value),style:{width:"fit-content"},"bt-disabled":!1},{default:w(()=>[i(o,{icon:"save"}),e[34]||(e[34]=c(" Save & Apply "))]),_:1})])])):S("",!0),e[90]||(e[90]=t("h5",{style:{"text-align":"center"}},[t("b",null,"Playback")],-1)),i(k,null,{default:w(()=>[i(De,{style:{width:"400px"},"in-label":"Speed","model-value":ye.value,"onUpdate:modelValue":e[6]||(e[6]=l=>ye.value=l)},{default:w(()=>e[36]||(e[36]=[t("option",{value:"1000"},"Slowest",-1),t("option",{value:"500"},"Slower",-1),t("option",{value:"300"},"Moderate",-1),t("option",{value:"250"},"Faster",-1),t("option",{value:"200"},"Fastest",-1)])),_:1},8,["model-value"])]),_:1}),t("div",tl,[!D.value&&!E.value&&!U.value?(s(),re(M,{key:0,onClick:e[7]||(e[7]=l=>te.value=!te.value),"bt-disabled":!1},{default:w(()=>[i(o,{icon:"atom"}),e[37]||(e[37]=c(" Leak Detection"))]),_:1})):S("",!0),D.value?S("",!0):(s(),re(M,{key:1,onClick:Lt,"bt-disabled":!1},{default:w(()=>[i(o,{icon:"download"}),e[38]||(e[38]=c(" Import Snapshot "))]),_:1})),E.value&&U.value?(s(),re(M,{key:2,onClick:e[8]||(e[8]=l=>xe.value=!xe.value),"bt-disabled":!1},{default:w(()=>[i(o,{icon:"sliders"}),e[39]||(e[39]=c(" Settings "))]),_:1})):S("",!0),E.value&&U.value?(s(),re(M,{key:3,style:{background:"red"},onClick:at,"bt-disabled":!1},{default:w(()=>[i(o,{icon:"close"}),e[40]||(e[40]=c(" Quit Prediction"))]),_:1})):S("",!0)]),t("div",ll,[t("div",al,[t("label",{class:Z([`${x(b).textTheme}`]),style:{cursor:"pointer",padding:"10px",border:"1px solid #ccc","margin-bottom":"1rem","border-radius":"10px"}},[Ae(t("input",{"onUpdate:modelValue":e[9]||(e[9]=l=>J.value=l),type:"checkbox"},null,512),[[Ye,J.value]]),e[41]||(e[41]=c(" Auto-replay "))],2),t("label",{class:Z([`${x(b).textTheme}`]),style:{cursor:"pointer",padding:"10px",border:"1px solid #ccc","margin-bottom":"1rem","border-radius":"10px"}},[Ae(t("input",{"onUpdate:modelValue":e[10]||(e[10]=l=>X.value=l),type:"checkbox"},null,512),[[Ye,X.value]]),e[42]||(e[42]=c(" Autoplay on navigating "))],2),t("label",{class:Z([`${x(b).textTheme}`]),style:{cursor:"pointer",padding:"10px",border:"1px solid #ccc","margin-bottom":"1rem","border-radius":"10px"}},[Ae(t("input",{"onUpdate:modelValue":e[11]||(e[11]=l=>_.value=l),type:"checkbox"},null,512),[[Ye,_.value]]),e[43]||(e[43]=c(" Self Navigate "))],2),_.value?(s(),re(M,{key:0,onClick:e[12]||(e[12]=l=>_e.value=!_e.value),"bt-disabled":!1,type:"button",class:"slfnavbtn"},{default:w(()=>[i(o,{icon:"sliders"})]),_:1})):S("",!0)]),t("div",ol,[ne.value?(s(),n("label",{key:0,class:Z([`${x(b).textTheme}`]),style:{border:"1px solid #ccc",padding:"10px","border-radius":"10px"}},[c(g(x(q)(ce.value).format("ddd, DD MMM YY"))+"    ",1),i(o,{icon:F.value=="forward"?"caret-right":"caret-left"},null,8,["icon"]),c("    "+g(x(q)(ie.value).format("ddd, DD MMM YY")),1)],2)):S("",!0),ne.value?(s(),n("label",{key:1,class:Z([`${x(b).textTheme}`]),style:{cursor:"pointer",padding:"10px",border:"1px solid #ccc","border-radius":"10px"}},[Ae(t("input",{"onUpdate:modelValue":e[13]||(e[13]=l=>Ue.value=l),type:"checkbox"},null,512),[[Ye,Ue.value]]),e[44]||(e[44]=c(" Repeat "))],2)):S("",!0),i(M,{onClick:e[14]||(e[14]=l=>ge.value=!ge.value),"bt-disabled":!1,type:"button",class:"slfnavbtn"},{default:w(()=>[i(o,{icon:"calendar"})]),_:1}),ce.value&&ie.value?(s(),re(M,{key:2,onClick:Le,"bt-disabled":!1,class:"slfnavbtn"},{default:w(()=>[i(o,{icon:"close"})]),_:1})):S("",!0)])]),t("div",sl,[i(M,{"bt-disabled":K.value,onClick:je},{default:w(()=>[i(o,{icon:"backward"}),c("    "+g(x(q)(se.value).format("ddd, DD MMM YY")),1)]),_:1},8,["bt-disabled"]),t("span",nl,[t("b",{style:Y({color:`${x(b).accentColor}`})},g(x(q)(v.initDateFilter).format("ddd, DD MMM YY")),5),e[48]||(e[48]=t("br",null,null,-1)),ne.value?(s(),n("span",{key:0,class:Z([`${x(b).textTheme}`]),style:{"font-size":"11px"}},[e[45]||(e[45]=c("Stops at: ")),t("b",null,g(x(q)(ie.value).format("ddd, DD MMM YY")),1)],2)):(s(),n(O,{key:1},[J.value?(s(),n("span",il,[e[46]||(e[46]=c("Repeating: ")),t("b",null,g(x(q)(v.initDateFilter).format("ddd,DD MMM YY")),1)])):(s(),n(O,{key:1},[de.value?(s(),n("span",ul,"[End of playback  ·  Autoplay stopped]")):(s(),n("span",rl,[e[47]||(e[47]=c("Upcoming: ")),t("b",null,g(x(q)(gt()).format("ddd, DD MMM YY")),1)]))],64))],64))]),i(M,{"bt-disabled":de.value,onClick:we},{default:w(()=>[c(g(x(q)(Ce.value).format("ddd, DD MMM YY"))+"    ",1),i(o,{icon:"forward"})]),_:1},8,["bt-disabled"])]),t("div",{style:Y([{position:"relative",width:"100%"},{marginBottom:Object.keys(h.value).length>1?"8rem":"0"}])},[t("div",{ref_key:"heatMap",ref:ae,style:{width:"100%",height:"600px"}},null,512),t("div",dl,[t("div",pl,[D.value?S("",!0):(s(),n("button",{key:0,style:{"z-index":"1",position:"relative"},onClick:e[15]||(e[15]=l=>D.value=!D.value),class:"controlbtn",type:"button"},[i(o,{icon:"play"})])),D.value?(s(),n("button",{key:1,style:{"z-index":"1",position:"relative"},onClick:e[16]||(e[16]=l=>D.value=!D.value),class:"controlbtn",type:"button"},[i(o,{icon:"pause"})])):S("",!0)]),t("div",cl,[t("input",{onChange:pe,type:"range",min:0,max:v.initPlaybackDatas.length,value:T.value,class:"slider"},null,40,vl)]),t("div",null,[!D.value&&T.value==v.initPlaybackDatas.length?(s(),n("button",{key:0,onClick:P,class:"controlbtn",type:"button"},[i(o,{icon:"undo"})])):S("",!0)])]),Object.keys(h.value).length?(s(),n("div",fl,[t("div",yl,[(s(!0),n(O,null,j(h.value,(l,d)=>(s(),n("div",{key:d,class:"selection-item",onClick:y=>xt(l,d)},[t("h5",{style:Y({color:l.type=="normal"?"red":"blue"})},[t("b",null,g(l.name),1)],4),(s(!0),n(O,null,j(l.data,y=>(s(),n("div",{key:y.seriesName},[y.seriesName!="Normal"&&!y.seriesName.includes("Drop")?(s(),n("span",bl,[t("span",gl,g(y.seriesName),1),e[49]||(e[49]=c()),t("span",kl,[t("b",null,g(y.yValue)+" PSI",1)])])):S("",!0)]))),128))],8,ml))),128))]),t("div",hl,[e[54]||(e[54]=t("h4",{style:{"text-align":"center"}},[t("b",null,"Pressure Distribution")],-1)),I.value?(s(),re(Bt,{key:0,style:{width:"100%"},data:x(R),"selected-spot":v.selectedSpot},null,8,["data","selected-spot"])):S("",!0),t("img",{src:x(jt),alt:"map",style:{width:"100%",height:"600px","border-radius":"10px","object-fit":"contain"}},null,8,xl),t("div",wl,[t("h5",Dl,[t("b",null,[i(o,{icon:"oil-well"}),e[50]||(e[50]=c(" Selected Pressures"))])]),t("table",Sl,[t("thead",null,[t("tr",{style:{padding:"5px"},class:Z([`${x(b).textTheme}`])},[t("th",{style:Y({border:`1px solid ${x(b).accentColor}`})},"ACTION",4),t("th",{style:Y({border:`1px solid ${x(b).accentColor}`})},"PINNED SERIES ",4),(s(!0),n(O,null,j(st(ue.value[v.selectedSpot]),(l,d)=>(s(),n("th",{style:Y({border:`1px solid ${x(b).accentColor}`}),key:d},g(l.name),5))),128))],2)]),t("tbody",null,[(s(!0),n(O,null,j(x(Pe),(l,d)=>(s(),n("tr",{key:d},[t("td",{style:Y({border:`1px solid ${x(b).accentColor}`,position:"relative",textTransform:"uppercase",fontWeight:"bold"})},null,4),t("td",{class:Z([`${x(b).textTheme}`]),style:Y({border:`1px solid ${x(b).accentColor}`,position:"relative",textTransform:"uppercase",fontWeight:"bold"})},[c(g(x(R)[l].date),1),e[51]||(e[51]=t("br",null,null,-1)),c(" "+g(x(R)[l].timerange),1),e[52]||(e[52]=t("br",null,null,-1)),c(" "+g(x(R)[l].type),1)],6),(s(!0),n(O,null,j(st(ue.value[v.selectedSpot]),(y,N)=>(s(),n("td",{style:Y({border:`1px solid ${x(b).accentColor}`}),class:Z([`${x(b).textTheme}`]),key:N},[ft(l,y.id)?(s(),n(O,{key:0},[c(g(ft(l,y.id)),1)],64)):(s(),n(O,{key:1},[c("0.00")],64))],6))),128))]))),128))])]),t("h5",Cl,[t("b",null,[i(o,{icon:"turn-down"}),e[53]||(e[53]=c(" Delta"))])]),t("table",$l,[t("thead",null,[t("tr",{style:{padding:"5px"},class:Z([`${x(b).textTheme}`])},[t("th",{style:Y({border:`1px solid ${x(b).accentColor}`})},"DROPS",4),t("th",{style:Y({border:`1px solid ${x(b).accentColor}`})},"PINNED SERIES ",4),(s(!0),n(O,null,j(st(ue.value[v.selectedSpot]),(l,d)=>(s(),n("th",{style:Y({border:`1px solid ${x(b).accentColor}`}),key:d},g(l.name),5))),128))],2)]),t("tbody",null,[(s(!0),n(O,null,j(u.value,(l,d)=>(s(),n("tr",{key:d},[t("td",{style:Y({border:`1px solid ${x(b).accentColor}`})},g(d+1),5),t("td",{style:Y({border:`1px solid ${x(b).accentColor}`})},g(l.dropKey.split(".")[0]+"."+l.dropKey.split(".")[1]+"."+l.dropKey.split(".")[2]),5),(s(!0),n(O,null,j(l.deltas,(y,N)=>(s(),n("td",{key:N,style:Y({border:`1px solid ${x(b).accentColor}`})},[Vt(y,l.deltas)?(s(),n("span",Ml,g(y.toFixed(2)),1)):Ft(y,l.deltas)?(s(),n("span",Pl,g(y.toFixed(2)),1)):Et(y,l.deltas)?(s(),n("span",Ol,g(y.toFixed(2)),1)):Nt(y,l.deltas)?(s(),n("span",_l,g(y.toFixed(2)),1)):(s(),n("span",Ll,g(y.toFixed(2)),1))],4))),128))]))),128))])])])])])):S("",!0)],4),fe.value?(s(),n("div",Tl,e[55]||(e[55]=[t("img",{src:"https://cdn.dribbble.com/users/1138184/screenshots/3796132/oil.gif"},null,-1)]))):S("",!0),te.value?(s(),n("div",Vl,[t("div",Fl,[t("button",{onClick:wt,class:"modelpick-dismiss"},[i(o,{icon:"times"})]),e[58]||(e[58]=t("h2",null,[t("b",null,"Leak Detection")],-1)),i(De,{"in-label":"Select Model","model-value":U.value,"onUpdate:modelValue":e[17]||(e[17]=l=>U.value=l)},{default:w(()=>e[56]||(e[56]=[t("option",{value:""},"Select...",-1),t("option",{value:"normal_pick"},"Normal Pick",-1),t("option",{value:"ranged_pick"},"Ranged Pick",-1)])),_:1},8,["model-value"]),i(De,{"in-label":"Select Prediction Method","model-value":E.value,"onUpdate:modelValue":e[18]||(e[18]=l=>E.value=l)},{default:w(()=>e[57]||(e[57]=[t("option",{value:""},"Select method...",-1),t("option",{value:"rf_multi"},"RF Multi-leak",-1),t("option",{value:"dtree_multi"},"DTree Multi-leak",-1)])),_:1},8,["model-value"]),i(M,{onClick:e[19]||(e[19]=l=>te.value=!te.value),style:{width:"fit-content","margin-top":"0.5rem"},"bt-disabled":!1},{default:w(()=>[c(g(Te.value?"Update Preference":"Start Picking"),1)]),_:1})])])):S("",!0),Object.keys(h.value).length>1&&!Me.value&&U.value?(s(),n("div",El,[t("button",{type:"button",class:"predict-action-hide",onClick:e[20]||(e[20]=l=>Me.value=!Me.value)},[i(o,{icon:"eye-slash"})]),t("div",Nl,[e[59]||(e[59]=c("Picking Model: ")),t("b",null,g(U.value.split("_").map(l=>l.charAt(0).toUpperCase()+l.slice(1)).join("")),1),e[60]||(e[60]=c(" ··· Prediction Method: ")),t("b",null,g(E.value.split("_").map(l=>l.charAt(0).toUpperCase()+l.slice(1)).join(" ")),1)]),t("div",zl,[e[61]||(e[61]=c("Num of drops: ")),t("b",null,g(Object.keys(h.value).filter(l=>h.value[l].type=="drop").length),1)]),t("div",Al,[i(M,{"bt-size":"small",onClick:Ct,"bt-disabled":!1,style:{width:"fit-content"}},{default:w(()=>[i(o,{icon:"check"}),e[62]||(e[62]=c(" Predict "))]),_:1}),i(M,{"bt-size":"small",onClick:Pt,"bt-disabled":!1,style:{width:"fit-content",background:"rgb(0,150,255)"}},{default:w(()=>[i(o,{icon:"plus"}),e[63]||(e[63]=c(" Create Snapshot "))]),_:1}),i(M,{"bt-size":"small",onClick:Dt,"bt-disabled":!1,style:{width:"fit-content",background:"#666"}},{default:w(()=>[i(o,{icon:"refresh"}),e[64]||(e[64]=c(" Change Method "))]),_:1}),i(M,{"bt-size":"small",onClick:Oe,"bt-disabled":!1,style:{width:"fit-content",background:"orange"}},{default:w(()=>[i(o,{icon:"trash"}),e[65]||(e[65]=c(" Clear Selection "))]),_:1}),i(M,{"bt-size":"small",onClick:at,"bt-disabled":!1,style:{width:"fit-content",background:"red"}},{default:w(()=>[i(o,{icon:"close"}),e[66]||(e[66]=c(" Quit Prediction "))]),_:1})])])):S("",!0),Ve.value?(s(),n("div",Yl,[t("div",{class:Z(["leak-body",[`${x(b).mTheme}`]])},[t("button",{type:"button",onClick:e[21]||(e[21]=l=>Ve.value=!1),class:"leak-dismiss"},[i(o,{icon:"times"})]),t("div",{class:"l-left",style:Y({width:$e.value?"40%":"100%"})},[e[79]||(e[79]=t("h4",{style:{"font-weight":"bold"}},"Leak Analysis",-1)),e[80]||(e[80]=t("hr",null,null,-1)),le.value?(s(!0),n(O,{key:0},j(le.value,(l,d)=>(s(),n("div",{class:"analysis-set",key:d},[l!=!1?(s(),n(O,{key:0},[t("h4",Rl,[t("b",null," DROP "+g(l.drop),1)]),t("p",null,[e[77]||(e[77]=c(" Result: ")),l!=!1&&l.suspectLocation.leak?(s(),n(O,{key:0},[e[75]||(e[75]=t("b",{style:{color:"red"}},"Possible leak detected!",-1)),t("div",jl,[t("table",Il,[t("tr",null,[e[67]||(e[67]=t("th",{style:{border:"1px solid #ccc",padding:"10px"}}," Estimated Leak Point",-1)),l.suspectLocation.leakData.pu_location?(s(),n("th",Ul," PU ")):S("",!0),l.suspectLocation.leakData.coordinate?(s(),n("th",ql," Coordinate ")):S("",!0)]),t("tbody",null,[t("tr",null,[t("td",Bl,g(l.suspectLocation.leakData.leak_point)+" KM ",1),l.suspectLocation.leakData.pu_location?(s(),n("td",Kl," KM "+g(l.suspectLocation.leakData.pu_location),1)):S("",!0),l.suspectLocation.leakData.coordinate?(s(),n("td",Wl,[e[69]||(e[69]=c(" LatLng: ")),t("code",null,g(l.suspectLocation.leakData.coordinate.latitude+", "+l.suspectLocation.leakData.coordinate.longitude),1),e[70]||(e[70]=t("br",null,null,-1)),e[71]||(e[71]=c(" DMS: ")),t("code",null,g(`${Be(l.suspectLocation.leakData.coordinate.latitude)}, ${Be(l.suspectLocation.leakData.coordinate.longitude)}`),1),e[72]||(e[72]=t("br",null,null,-1)),i(M,{onClick:y=>Mt(`LATLNG: ${l.suspectLocation.leakData.coordinate.latitude}, ${l.suspectLocation.leakData.coordinate.longitude}
DMS: ${Be(l.suspectLocation.leakData.coordinate.latitude)}, ${Be(l.suspectLocation.leakData.coordinate.longitude)}`),style:{"margin-top":"5px"},"bt-disabled":!1,"bt-size":"small"},{default:w(()=>[i(o,{icon:"copy"}),e[68]||(e[68]=c(" Copy Coord "))]),_:2},1032,["onClick"])])):S("",!0)])])])]),l.suspectLocation.leakData.coordinate?S("",!0):(s(),n("p",Gl,[i(o,{icon:"info-circle"}),e[73]||(e[73]=c(" Map view and PU Location data is currently not supported for this line "))])),i(M,{onClick:y=>$t(l.suspectLocation.leakData.coordinate,l.suspectLocation.leakData.leak_point,l.suspectLocation.leakData.pu_location),"bt-disabled":!l.suspectLocation.leakData.coordinate},{default:w(()=>[i(o,{icon:"map-marker"}),e[74]||(e[74]=c(" Pinpoint on Map "))]),_:2},1032,["onClick","bt-disabled"]),l.suspectLocation.leakData.coordinate?(s(),n("a",{key:1,class:"gmaps",target:"_blank",href:`https://www.google.com/maps?q=${l.suspectLocation.leakData.coordinate.latitude},${l.suspectLocation.leakData.coordinate.longitude}`,style:{"margin-left":"0.5rem"}},"Google Maps",8,Hl)):S("",!0)],64)):(s(),n(O,{key:1},[e[76]||(e[76]=t("b",{style:{color:"#555"}},"No leak detected",-1)),t("ol",Ql,[(s(!0),n(O,null,j(l.suspectLocation.probabilities,(y,N)=>(s(),n("li",{key:N},g(y),1))),128))])],64))])],64)):(s(),n("h6",Jl,[t("b",null,"Analysis on Dataset "+g(d+1),1),e[78]||(e[78]=t("b",{style:{color:"#555"}},"Tidak ada indikasi",-1)),t("ol",Xl,[(s(!0),n(O,null,j(l.suspectLocation.probabilities,(y,N)=>(s(),n("li",{key:N},g(y),1))),128))])]))]))),128)):(s(),re(Ht,{key:1,message:"Calculating leak probabilities..."}))],4),$e.value?(s(),n("div",{key:0,class:"l-right",style:Y({width:$e.value?"60%":"100%",position:"relative"})},[e[81]||(e[81]=t("h4",{style:{"font-weight":"bold"}},"Map View",-1)),e[82]||(e[82]=t("hr",null,null,-1)),i(It,{latitude:qe.value.latitude,longitude:qe.value.longitude,"leak-point":ct.value,"pu-location":vt.value},null,8,["latitude","longitude","leak-point","pu-location"])],4)):S("",!0)],2)])):S("",!0),xe.value?(s(),n("div",Zl,[t("div",ea,[e[85]||(e[85]=t("h5",null,[t("b",null,"Prediction Mode Preferences")],-1)),e[86]||(e[86]=t("hr",null,null,-1)),i(ke,{"in-label":"Dot Symbol Size","model-value":Q.value,"onUpdate:modelValue":e[22]||(e[22]=l=>Q.value=l),"in-type":"number"},null,8,["model-value"]),t("label",ta,[Ae(t("input",{type:"checkbox","onUpdate:modelValue":e[23]||(e[23]=l=>me.value=l)},null,512),[[Ye,me.value]]),e[83]||(e[83]=t("div",{style:{display:"flex","flex-flow":"column","margin-left":"0.7rem"}},[t("span",{style:{"font-size":"13px"}},[t("b",null,"Show all dots")]),t("span",{style:{"font-size":"11px"}},"Show all dots or reduce the dot placement")],-1))]),i(M,{onClick:e[24]||(e[24]=l=>xe.value=!xe.value),style:{width:"fit-content"},"bt-disabled":!1},{default:w(()=>e[84]||(e[84]=[c(" Save Preferences")])),_:1})])])):S("",!0),Ke.value?(s(),n("div",la,[t("div",aa,[e[89]||(e[89]=t("h2",null,[t("b",null,"Snapshot")],-1)),i(ke,{"in-label":"Name","model-value":Fe.value,"onUpdate:modelValue":e[25]||(e[25]=l=>Fe.value=l),"in-type":"text"},null,8,["model-value"]),i(ke,{"in-label":"Description","model-value":Ee.value,"onUpdate:modelValue":e[26]||(e[26]=l=>Ee.value=l),"in-type":"text"},null,8,["model-value"]),t("div",oa,[i(M,{onClick:_t,style:{width:"fit-content"},"bt-disabled":!1},{default:w(()=>[i(o,{icon:"save"}),e[87]||(e[87]=c(" Create "))]),_:1}),i(M,{onClick:Ot,style:{width:"fit-content"},"bt-disabled":!1},{default:w(()=>e[88]||(e[88]=[c("Cancel ")])),_:1})])])])):S("",!0),Me.value?(s(),n("button",{key:8,type:"button",onClick:e[27]||(e[27]=l=>Me.value=!Me.value),class:"predict-action-show"},[i(o,{icon:"eye"})])):S("",!0)],64)}}}),na=rt(sa,[["__scopeId","data-v-c3d000d5"]]),ia={class:"row"},ra={class:"col-md-3"},ua=["value"],da={style:{display:"flex","flex-flow":"row nowrap","align-items":"center",gap:"1rem"}},pa={style:{display:"flex","flex-flow":"row nowrap",gap:"1rem","align-items":"center"}},ca={class:"col-md-12",style:{position:"relative"}},va={key:0,class:"loaders"},fa={key:0,class:"load-window"},ya={class:"load-inner"},ma={style:{display:"flex","flex-flow":"column","align-items":"flex-start",gap:"0.2rem"}},ba={style:{margin:"0",padding:"0"}},ga={style:{"font-size":"9px",color:"red"}},ka={style:{"font-size":"11px","margin-bottom":"1rem"}},ha={style:{display:"flex","flex-flow":"row wrap","font-size":"11px",gap:"0.2rem",border:"1px solid #ccc",width:"100%",padding:"10px","border-radius":"10px"}},xa={style:{color:"#555",padding:"5px",background:"#ddd","border-radius":"5px"}},wa={style:{display:"flex","flex-flow":"row wrap","font-size":"11px",gap:"0.2rem",border:"1px solid #ccc",width:"100%",padding:"10px","border-radius":"10px"}},Da={style:{color:"#555",padding:"10px",background:"#eee","border-radius":"5px","text-align":"center"}},Sa={style:{display:"flex","flex-flow":"row wrap","font-size":"12px",background:"#eee",padding:"10px","border-radius":"10px",border:"1px solid #ccc",width:"100%"}},Ca={style:{"margin-right":"10px","font-weight":"bold"}},$a={style:{"font-weight":"bold"}},Ma={style:{"font-weight":"bold"}},Pa={style:{"font-weight":"bold"}},Oa={style:{display:"flex","flex-flow":"row nowrap",gap:"0.3rem"}},_a={key:1,style:{display:"flex","flex-flow":"column","align-items":"center","justify-content":"center",gap:"1rem"}},La={style:{"font-size":"30px"}},Ta=Ze({__name:"PlaybackFol",setup(Se){const ee=nt(),B=mt();B.asideToggle(!1);const W=r(ee.getAllTrunk()),z=r("trunk1"),b=r();b.value=Object.keys(W.value);const F=r(5),_=r(),L=r([]),I=r(0),G=r([]),v=r(!1),ae=r(!1),p=r(!1),ue=r(!1),T=r(!0),ve=r(null),Re=bt(),fe=()=>{I.value++,L.value.push(null)};it(()=>{const f=Re.params.saveid;f?setTimeout(async()=>{const u="https://rtunode.findingoillosses.com/api/v1/getpresetbyid",C={key:f},m=await Qe.post(u,C),$=m.data.status,V=m.data.data;if($===200){const P=V;G.value=[],L.value=[];const pe=P.dates;I.value=0,F.value=P.timerange,_.value=pe[0];for(let be=1;be<pe.length;be++)fe();setTimeout(()=>{document.querySelectorAll('input[type="date"]').forEach((be,we)=>{be.value=pe[we],L.value[we]=be}),de(),ve.value={name:P.name,desc:P.desc,selectedMethod:P.selectedMethod,selectedModel:P.selectedModel,selection:P.selections,seekerValue:P.seekerValue},ae.value=!0},100)}else B.notifyShowError("Failed fetching snapshot!")},1e3):(ye(),ae.value=!0)}),A(()=>[_.value,F.value,z.value],async()=>{ue.value=!1,p.value=!0,await de()});const ye=()=>{const f=new Date,u=f.getFullYear(),C=String(f.getMonth()+1).padStart(2,"0"),m=String(f.getDate()).padStart(2,"0"),$=`${u}-${C}-${m}`;_.value=$},H=async f=>new Promise(async(u,C)=>{try{const m=W.value[z.value];let $=[];for(let pe=0;pe<m.spot.length;pe++)$.push(m.spot[pe].id);const V={datefilter:f,timeFilter:F.value,idFilter:$},P=await Qe.post(Yt.baseEnd+"api/History/getsplittedhistdata",V);u(P.data)}catch(m){C(m)}}),de=async()=>{try{v.value=!0;let u=[...await H(_.value)];if(L.value.length>0){for(let C=0;C<L.value.length;C++){const m=L.value[C];if(m!==null){if(m.value!==_.value){const $=await H(m.value);u=u.concat($)}}else console.log("Null")}p.value=!1}G.value=u,v.value=!1}catch(f){console.log(f),p.value=!1,v.value=!1}},oe=async()=>new Promise(async(f,u)=>{try{v.value=!0;let m=[...await H(_.value)];if(L.value.length>0){for(let $=0;$<L.value.length;$++){const V=L.value[$];if(V!==null){if(V.value!==_.value){const P=await H(V.value);m=m.concat(P)}}else console.log("Null")}p.value=!1}G.value=m,v.value=!1,f(!0)}catch(C){console.log(C),p.value=!1,v.value=!1,u(!1)}}),he=(f,u)=>{L.value[u]=f,de()},et=()=>{I.value>0&&(I.value--,L.value.pop()),de()},Ce=f=>{_.value=f},se=r([]),J=async f=>{X();const u={};u.name=f.name,u.desc=f.desc,u.timerange=F.value,u.selectedModel=f.selectedModel,u.selectedMethod=f.selectedMethod,u.dates=se.value,u.selections=f.selections,u.seekerValue=f.seekerValue,u.context="jmbfol",(await Qe.post("https://rtunode.findingoillosses.com/api/v1/savepreset",u)).data.status===200?(B.notifyShow("Preset has been saved!"),se.value=[]):(B.notifyShowError("Failed saving preset!"),se.value=[])},X=()=>{if(se.value.push(_.value),L.value.length)for(let f in L.value)se.value.push(L.value[f].value)},D=r([]),K=r(!1),xe=()=>{K.value=!0,me()},me=async()=>{const f={context:"jmbfol"},u=await Qe.post("https://rtunode.findingoillosses.com/api/v1/getpresets",f);u.data.status===200?D.value=u.data.data:B.notifyShowError("Failed fetching snapshots!")},Q=async f=>{T.value=!1,G.value=null,L.value=[];const u=f.dates;I.value=0,F.value=f.timerange,_.value=u[0];for(let C=1;C<u.length;C++)fe();tt(u).then(async()=>{await oe().then(()=>{ve.value={name:f.name,desc:f.desc,selectedMethod:f.selectedMethod,selectedModel:f.selectedModel,selection:f.selections,seekerValue:f.seekerValue},K.value=!1,setTimeout(()=>{T.value=!0},1e3)})})},tt=f=>new Promise((u,C)=>{try{setTimeout(()=>{document.querySelectorAll('input[type="date"]').forEach((m,$)=>{m.value=f[$],L.value[$]=m}),u(!0)},50)}catch(m){C(m)}}),R=f=>{const u=`https://rantau.findingoillosses.com/fol/playback/${f.key}`;navigator.clipboard.writeText(u).then(()=>{B.notifyShow(`${f.name} -> Link copied. CTRL+V to paste`)}),K.value=!1},Pe=()=>{ve.value=null};return(f,u)=>{const C=Xe("font-awesome-icon");return s(),n(O,null,[i(zt,{"context-title":"Data Playback"},{default:w(()=>[t("div",ia,[t("div",ra,[u[6]||(u[6]=t("h4",null,[t("b",null,"Filter")],-1)),i(De,{"in-label":"Select Line","model-value":z.value,"onUpdate:modelValue":u[0]||(u[0]=m=>z.value=m)},{default:w(()=>[(s(!0),n(O,null,j(b.value,(m,$)=>(s(),n("option",{key:$,value:m},g(W.value[m].name),9,ua))),128))]),_:1},8,["model-value"]),i(De,{"in-label":"Time Range","model-value":F.value,"onUpdate:modelValue":u[1]||(u[1]=m=>F.value=m)},{default:w(()=>u[5]||(u[5]=[t("option",{value:"1"},"1 Minute",-1),t("option",{value:"2"},"2 Minutes",-1),t("option",{value:"3"},"3 Minutes",-1),t("option",{value:"4"},"4 Minutes",-1),t("option",{value:"5"},"5 Minutes",-1),t("option",{value:"10"},"10 Minutes",-1),t("option",{value:"15"},"15 Minutes",-1),t("option",{value:"30"},"30 Minutes",-1),t("option",{value:"60"},"60 Minutes",-1)])),_:1},8,["model-value"]),t("div",da,[i(ke,{"in-type":"date","in-label":"Date Filter","model-value":_.value,"onUpdate:modelValue":u[2]||(u[2]=m=>_.value=m),style:{width:"100%"}},null,8,["model-value"])]),t("div",pa,[i(M,{onClick:et,"bt-size":"small","bt-type":"button","bt-disabled":!1},{default:w(()=>[i(C,{icon:"minus"})]),_:1}),t("span",{class:Z([`${x(B).textTheme}`])},g(I.value),3),i(M,{onClick:fe,"bt-size":"small","bt-type":"button","bt-disabled":!1},{default:w(()=>[i(C,{icon:"plus"})]),_:1})]),(s(!0),n(O,null,j(I.value,(m,$)=>(s(),n("div",{key:$,style:{display:"flex","flex-flow":"row nowrap","align-items":"center",gap:"1rem"}},[i(ke,{"in-type":"date","in-label":`Date Filter ${m}`,onOnValueChange:V=>he(V,$),style:{width:"100%"}},null,8,["in-label","onOnValueChange"])]))),128))]),t("div",ca,[v.value&&ae.value?(s(),n("div",va,u[7]||(u[7]=[t("img",{src:"https://cdn.dribbble.com/users/1138184/screenshots/3796132/oil.gif",style:{width:"350px",height:"350px","object-fit":"contain","border-radius":"20px"}},null,-1)]))):S("",!0),G.value&&T.value?(s(),re(na,{key:1,"snap-shots":ve.value,onOnDataSave:J,onOnLoadPreset:xe,"init-date-filter":_.value,"selected-spot":z.value,"init-playback-datas":G.value,onOnSnapshotUnloaded:Pe,onOnDateChange:Ce},null,8,["snap-shots","init-date-filter","selected-spot","init-playback-datas"])):S("",!0)])])]),_:1}),K.value?(s(),n("div",fa,[t("div",ya,[t("button",{type:"button",class:"load-dismiss",onClick:u[3]||(u[3]=m=>K.value=!K.value)},[i(C,{icon:"times"})]),D.value.length>0?(s(),n(O,{key:0},[u[13]||(u[13]=t("h2",{style:{"padding-left":"1rem"}},[t("b",null,"Saved Snapshots")],-1)),(s(!0),n(O,null,j(D.value,(m,$)=>(s(),n("div",{class:"preset-item",key:$},[t("div",ma,[t("h5",ba,[t("b",null,[c(g(m.name)+" ",1),t("sup",ga,[t("b",null,"#"+g(m.key),1)])])]),t("div",ka,[u[8]||(u[8]=c("Description: ")),t("b",null,g(m.desc),1)]),t("div",ha,[(s(!0),n(O,null,j(m.dates,(V,P)=>(s(),n("div",{key:P,style:{"font-weight":"bold"}},[t("div",xa,[t("b",null,[i(C,{icon:"calendar"}),c(" "+g(V),1)])])]))),128))]),t("div",wa,[(s(!0),n(O,null,j(m.selections,(V,P)=>(s(),n("div",{key:P,style:{"font-weight":"bold",width:"150px"}},[t("div",Da,[t("b",{style:Y({color:`${V.type=="drop"?"red":"green"}`})},g(`${V.name}: (${V.timerange})`),5)])]))),128))]),t("div",Sa,[t("span",Ca,[u[9]||(u[9]=c("Pick: ")),t("code",$a,g(m.selectedModel),1)]),t("span",Ma,[u[10]||(u[10]=c("Prediction: ")),t("code",Pa,g(m.selectedMethod),1)])]),t("div",Oa,[i(M,{"bt-disabled":!1,"bt-size":"small","bt-type":"button",onClick:V=>Q(m),style:{"margin-top":"1rem"}},{default:w(()=>[i(C,{icon:"plus"}),c(" Import "+g(m.name),1)]),_:2},1032,["onClick"]),i(M,{"bt-disabled":!1,"bt-size":"small","bt-type":"button",onClick:V=>R(m),style:{"margin-top":"1rem"}},{default:w(()=>[i(C,{icon:"copy"}),u[11]||(u[11]=c(" Copy Share Link "))]),_:2},1032,["onClick"]),i(M,{"bt-disabled":!1,"bt-size":"small","bt-type":"button",onClick:u[4]||(u[4]=V=>K.value=!K.value),style:{"margin-top":"1rem",background:"red"}},{default:w(()=>[i(C,{icon:"trash"}),u[12]||(u[12]=c(" Delete "))]),_:1})])])]))),128))],64)):(s(),n("div",_a,[t("span",La,[i(C,{icon:"inbox"})]),u[14]||(u[14]=t("h5",{style:{padding:"0",margin:"0"}},"No Snapshot(s) Found!",-1)),u[15]||(u[15]=t("p",{style:{padding:"0",margin:"0","text-align":"center"}},[c("To add a new Snapshot, select Normal & Drop(s) on active Leak Detection chart and click "),t("b",null,"Create Snapshot")],-1))]))])])):S("",!0)],64)}}}),qa=rt(Ta,[["__scopeId","data-v-5bddf5b0"]]);export{qa as default};
