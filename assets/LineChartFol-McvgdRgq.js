import{u as D}from"./theme-DOSqIxAS.js";import{i as R}from"./index-CehbAW_K.js";import{d as P,e as d,l as L,j as z,o as b,c as A,a as w,g as u,t as J,h as T,u as $,n as U,m as q,p as E,f as I,w as O,z as H,F as j}from"./index-CvBlZj70.js";import{a as W}from"./axios-BimPEqV4.js";import{_ as Y}from"./BatteryView.vue_vue_type_style_index_0_computed_true_lang-CyCnl0dE.js";import{_ as X}from"./InputView.vue_vue_type_style_index_0_lang-CYEYkoW1.js";import{_ as Z}from"./MainWrapperView.vue_vue_type_style_index_0_lang-CcWtHl2C.js";import{_ as Q}from"./SelectView.vue_vue_type_style_index_0_lang-CwydNCpn.js";import"./moment-C5S46NFB.js";const ee={style:{width:"200px",position:"relative",background:"#eee",height:"5px","border-radius":"10px"}},te=P({__name:"ChartLineView",props:{ch_name:{type:String,required:!0},ch_spot:{type:[Number],required:!0},ch_filter_date:{type:String,required:!0},ch_ymax:{type:Number,default:500},ch_ymin:{type:Number,default:0},ch_timesplit:{type:Number,default:30}},setup(G){const s=D(),t=G,l=d(t.ch_ymax);d(0),t.ch_spot==1||t.ch_spot==2||t.ch_spot==15||t.ch_spot==16?l.value=200:t.ch_spot==3||t.ch_spot==4?l.value=300:t.ch_spot==9?l.value=100:(t.ch_spot==10||t.ch_spot==11||t.ch_spot==12||t.ch_spot==13)&&(l.value=250);const _=d(null),m=d(!0),n=d(0),i=d(null),c=d(!1),f=d([]),x={notMerge:!0,lazyUpdate:!0,tooltip:{trigger:"axis",axisPointer:{type:"cross"}},toolbox:{feature:{dataZoom:{yAxisIndex:"none"},dataView:{readOnly:!1},magicType:{type:["line","bar"]},restore:{},saveAsImage:{},brush:{type:["lineX","clear"]}},iconStyle:{color:`${s.accentColor}`}},axisPointer:{link:{xAxisIndex:"all"},label:{backgroundColor:"#777"}},legend:{textStyle:{color:`${s.accentColor}`}},xAxis:{name:"Time",type:"category",nameLocation:"middle",nameTextStyle:{lineHeight:60},axisLine:{show:!0},splitLine:{show:!0,lineStyle:{color:"#cccccccc"}},axisLabel:{rotate:-45,color:`${s.accentColor}`,interval:r=>(f.value[r].split(":")[0],f.value[r].split(":")[1]%t.ch_timesplit===0)},boundaryGap:!1,axisTick:{alignWithLabel:!0}},yAxis:{name:"Pressure (PSI)",nameLocation:"middle",min:t.ch_ymin,nameGap:40,max:l.value,splitLine:{lineStyle:{color:"#ccccccaa"}},nameTextStyle:{verticalAlign:"middle"},axisTick:{show:!0},axisLabel:{color:`${s.accentColor}`},type:"value",axisLine:{show:!0}},series:[]};setTimeout(()=>{i.value.setOption(x)},500);const B=r=>new Date(r).toISOString(),M=async()=>{try{const r={id:t.ch_spot+"",date:B(t.ch_filter_date)},p=await W.post(E.baseEnd+"api/Data/getspotdata",r);n.value=80;const g=p.data.map(v=>{const o=v.timestamp.replace(".",":").split("T")[1],[a,S]=o.split(":");return`${a}:${S}`});f.value=g,n.value=85;const C=p.data.map(v=>parseFloat(v.psiValue).toFixed(2));x.xAxis=[{type:"category",data:g}],x.series=[{name:"Pressure",data:C,type:"line",itemStyle:{normal:{color:"#06B800",color0:"#FA0000",borderColor:null,borderColor0:null,opacity:0}},endLabel:{show:!0,fontSize:8,color:"#fff",offset:[-5,0],padding:3,borderRadius:3,textBorderWidth:0,backgroundColor:s.accentColorSecondary,formatter:function(v){const y=C;let o=0,a=0,S=0;for(let h=0;h<y.length;h++)y[h]>S&&(S=y[h]);for(let h=0;h<y.length;h++){const e=parseInt(y[h]);(t.ch_spot==1&&e>=128&&e<=150||t.ch_spot==2&&e>=70&&e<=100||t.ch_spot==3&&e>=120&&e<=150||t.ch_spot==4&&e>=16&&e<=38||t.ch_spot==5&&e>=250&&e<=300||t.ch_spot==6&&e>=225&&e<=250||t.ch_spot==7&&e>=50&&e<=100||t.ch_spot==8&&e>=200&&e<=260||t.ch_spot==9&&e>=38&&e<=50||t.ch_spot==10&&e>=10&&e<=56||t.ch_spot==11&&e>=7&&e<=35||t.ch_spot==12&&e>=38&&e<=50||t.ch_spot==13&&e>=3&&e<=30||t.ch_spot==14&&e>=38&&e<=50)&&(o+=e,a++)}const k=v.data,F=S,V=(F-k)/F*100,K=o/a;return`Cur: ${parseFloat(v.data).toFixed(2)}
Avg: ${parseFloat(K).toFixed(2)}
Delt: ${V.toFixed(2)}%`}},lineStyle:{color:"#007BFF",width:2}}],i.value.setOption(x),n.value=99,setTimeout(()=>{m.value=!1,n.value=0},1e3)}catch(r){console.log(r),m.value=!1}c.value=!0},N=()=>new Promise((r,p)=>{const g={toolbox:{iconStyle:{color:`${s.accentColor}`}},legend:{textStyle:{color:`${s.accentColor}`}},xAxis:{axisLabel:{rotate:-45,color:`${s.accentColor}`}},yAxis:{splitLine:{lineStyle:{color:"#cccccc11"}},axisLabel:{color:`${s.accentColor}`}}};try{i.value.setOption(g),r()}catch(C){p(C)}});return L(()=>[i.value,t.ch_filter_date],()=>{m.value=!0,n.value=0,setTimeout(()=>{i.value.setOption({series:[]}),n.value=12,M()},500)}),L(()=>[s.accentColor],async()=>{await N().then(()=>{})}),L(()=>t.ch_timesplit,()=>{const r={xAxis:{axisLabel:{rotate:-45,color:`${s.accentColor}`,interval:p=>(f.value[p].split(":")[0],f.value[p].split(":")[1]%t.ch_timesplit===0)}}};i.value.setOption(r)}),setInterval(()=>{c.value&&M()},15e3),z(()=>{const r=R(_.value);i.value=r}),(r,p)=>(b(),A("div",{class:"chparent",style:T({border:`1px solid ${$(s).accentColor}`})},[w(Y,{"id-spot":t.ch_spot},null,8,["id-spot"]),u("h3",{style:T({color:`${$(s).accentColorSecondary}`})},J(t.ch_name),5),u("div",{ref_key:"chart",ref:_,style:{width:"565px",height:"300px"}},null,512),m.value?(b(),A("div",{key:0,class:U(["chloader",[`${$(s).mTheme}`]])},[p[0]||(p[0]=u("img",{src:"https://i.pinimg.com/originals/cb/17/b8/cb17b80a942d7c317a35ff1324fae12f.gif"},null,-1)),u("div",ee,[u("span",{style:T([{"border-radius":"10px",position:"absolute",top:"0",left:"0",height:"100%",transition:"ease-in-out 1s"},{width:`${n.value}%`,background:`${$(s).accentColor}`}])},null,4)])],2)):q("",!0)],4))}}),oe={class:"col-md-3"},ae={class:"chartcontainer"},he=P({__name:"LineChartFol",setup(G){D().asideToggle(!1);const t=()=>{const n=new Date,i=n.getFullYear(),c=String(n.getMonth()+1).padStart(2,"0"),f=String(n.getDate()).padStart(2,"0");return`${i}-${c}-${f}`},l=d(60),_=d(t()),m=d({1:{spot:"MGS BJG",id:1},2:{spot:"MGS BJG (1)",id:15},3:{spot:"BOOSTER",id:2},4:{spot:"MGS BJG (2)",id:16},5:{spot:"MGS KAS",id:3},6:{spot:"MOS TPN",id:4},7:{spot:"GS 02 SGL",id:5},8:{spot:"GS 02 SGL (02)",id:6},9:{spot:"GS 02 SGL (03)",id:7},10:{spot:"GS 01 KTT",id:8},11:{spot:"MGS TPN",id:9},12:{spot:"0 KM SP BETUNG",id:10},13:{spot:"5.3 KM SIMP. PASAR GAJAH (5.3)",id:11},14:{spot:"9.5 KM SANDTRAP II (4.2)",id:12},15:{spot:"13.8 KM MGS BJG (4.3)",id:13},16:{spot:"MINIATUR (CIP)",id:14}});return(n,i)=>(b(),I(Z,{"context-title":"FOL | Line Chart"},{default:O(()=>[u("div",oe,[w(X,{"in-type":"date","in-label":"Date Filter","model-value":_.value,"onUpdate:modelValue":i[0]||(i[0]=c=>_.value=c)},null,8,["model-value"]),w(Q,{"in-label":"Time split","model-value":l.value,"onUpdate:modelValue":i[1]||(i[1]=c=>l.value=c)},{default:O(()=>i[2]||(i[2]=[u("option",{value:"5"},"5 Minutes",-1),u("option",{value:"15"},"15 Minutes",-1),u("option",{value:"30"},"30 Minutes",-1),u("option",{value:"45"},"45 Minutes",-1),u("option",{value:"60"},"1 Hour",-1)])),_:1},8,["model-value"])]),u("div",ae,[(b(!0),A(j,null,H(Object.keys(m.value),c=>(b(),I(te,{key:c,ch_timesplit:l.value,ch_name:m.value[c].spot,ch_filter_date:_.value,ch_spot:m.value[c].id},null,8,["ch_timesplit","ch_name","ch_filter_date","ch_spot"]))),128))])]),_:1}))}});export{he as default};
