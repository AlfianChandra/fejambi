import{u as D}from"./theme-c8omi_G4.js";import{i as R}from"./index-CehbAW_K.js";import{d as P,e as d,l as L,j as z,o as S,c as A,a as w,g as p,t as J,h as T,u as C,n as U,m as q,p as E,f as I,w as O,z as H,F as j}from"./index-CXyP7EXo.js";import{a as W}from"./axios-BimPEqV4.js";import{_ as Y}from"./BatteryView.vue_vue_type_style_index_0_computed_true_lang-BqlXPGNY.js";import{_ as X}from"./InputView.vue_vue_type_style_index_0_lang-DDFxUwmY.js";import{_ as Z}from"./MainWrapperView.vue_vue_type_style_index_0_lang-CQnhUN6k.js";import{_ as Q}from"./SelectView.vue_vue_type_style_index_0_lang-BiTlhAoj.js";import"./moment-C5S46NFB.js";const ee={style:{width:"200px",position:"relative",background:"#eee",height:"5px","border-radius":"10px"}},te=P({__name:"ChartLineView",props:{ch_name:{type:String,required:!0},ch_spot:{type:[Number],required:!0},ch_filter_date:{type:String,required:!0},ch_ymax:{type:Number,default:500},ch_ymin:{type:Number,default:0},ch_timesplit:{type:Number,default:30}},setup(G){const i=D(),t=G,s=d(t.ch_ymax);d(0),t.ch_spot==1||t.ch_spot==2||t.ch_spot==15||t.ch_spot==16?s.value=200:t.ch_spot==3||t.ch_spot==4?s.value=300:t.ch_spot==9?s.value=100:(t.ch_spot==10||t.ch_spot==11||t.ch_spot==12||t.ch_spot==13)&&(s.value=250);const f=d(null),m=d(!0),r=d(0),l=d(null),n=d(!1),$=d([]),y={notMerge:!0,lazyUpdate:!0,tooltip:{trigger:"axis",axisPointer:{type:"cross"}},toolbox:{feature:{dataZoom:{yAxisIndex:"none"},dataView:{readOnly:!1},magicType:{type:["line","bar"]},restore:{},saveAsImage:{},brush:{type:["lineX","clear"]}},iconStyle:{color:`${i.accentColor}`}},axisPointer:{link:{xAxisIndex:"all"},label:{backgroundColor:"#777"}},legend:{textStyle:{color:`${i.accentColor}`}},xAxis:{name:"Time",type:"category",nameLocation:"middle",nameTextStyle:{lineHeight:60},axisLine:{show:!0},splitLine:{show:!0,lineStyle:{color:"#cccccccc"}},axisLabel:{rotate:-45,color:`${i.accentColor}`},boundaryGap:!1,axisTick:{alignWithLabel:!0},data:[]},yAxis:{name:"Pressure (PSI)",nameLocation:"middle",min:t.ch_ymin,nameGap:40,max:s.value,splitLine:{lineStyle:{color:"#ccccccaa"}},nameTextStyle:{verticalAlign:"middle"},axisTick:{show:!0},axisLabel:{color:`${i.accentColor}`},type:"value",axisLine:{show:!0}},series:[]};setTimeout(()=>{l.value.setOption(y)},500);const B=c=>new Date(c).toISOString(),M=async()=>{try{const c={id:t.ch_spot+"",date:B(t.ch_filter_date)},u=await W.post(E.baseEnd+"api/Data/getspotdata",c);r.value=80;const x=u.data.map(_=>{const o=_.timestamp.replace(".",":").split("T")[1],[a,g]=o.split(":");return`${a}:${g}`});$.value=x,r.value=85;const b=u.data.map(_=>parseFloat(_.psiValue).toFixed(2));y.xAxis=[{data:x}],y.series=[{name:"Pressure",data:b,type:"line",itemStyle:{normal:{color:"#06B800",color0:"#FA0000",borderColor:null,borderColor0:null,opacity:0}},endLabel:{show:!0,fontSize:8,color:"#fff",offset:[-5,0],padding:3,borderRadius:3,textBorderWidth:0,backgroundColor:i.accentColorSecondary,formatter:function(_){const v=b;let o=0,a=0,g=0;for(let h=0;h<v.length;h++)v[h]>g&&(g=v[h]);for(let h=0;h<v.length;h++){const e=parseInt(v[h]);(t.ch_spot==1&&e>=128&&e<=150||t.ch_spot==2&&e>=70&&e<=100||t.ch_spot==3&&e>=120&&e<=150||t.ch_spot==4&&e>=16&&e<=38||t.ch_spot==5&&e>=250&&e<=300||t.ch_spot==6&&e>=225&&e<=250||t.ch_spot==7&&e>=50&&e<=100||t.ch_spot==8&&e>=200&&e<=260||t.ch_spot==9&&e>=38&&e<=50||t.ch_spot==10&&e>=10&&e<=56||t.ch_spot==11&&e>=7&&e<=35||t.ch_spot==12&&e>=38&&e<=50||t.ch_spot==13&&e>=3&&e<=30||t.ch_spot==14&&e>=38&&e<=50)&&(o+=e,a++)}const k=_.data,F=g,V=(F-k)/F*100,K=o/a;return`Cur: ${parseFloat(_.data).toFixed(2)}
Avg: ${parseFloat(K).toFixed(2)}
Delt: ${V.toFixed(2)}%`}},lineStyle:{color:"#007BFF",width:2}}],l.value.setOption(y),r.value=99,setTimeout(()=>{m.value=!1,r.value=0},1e3)}catch(c){console.log(c),m.value=!1}n.value=!0},N=()=>new Promise((c,u)=>{const x={toolbox:{iconStyle:{color:`${i.accentColor}`}},legend:{textStyle:{color:`${i.accentColor}`}},xAxis:{axisLabel:{rotate:-45,color:`${i.accentColor}`}},yAxis:{splitLine:{lineStyle:{color:"#cccccc11"}},axisLabel:{color:`${i.accentColor}`}}};try{l.value.setOption(x),c()}catch(b){u(b)}});return L(()=>[l.value,t.ch_filter_date],()=>{m.value=!0,r.value=0,setTimeout(()=>{l.value.setOption({series:[]}),r.value=12,M()},500)}),L(()=>[i.accentColor],async()=>{await N().then(()=>{})}),L(()=>t.ch_timesplit,()=>{const c={xAxis:{axisLabel:{formatter:u=>(u.split(":")[0],u.split(":")[1]%t.ch_timesplit===0)}}};l.value.setOption(c)}),setInterval(()=>{n.value&&M()},15e3),z(()=>{const c=R(f.value);l.value=c}),(c,u)=>(S(),A("div",{class:"chparent",style:T({border:`1px solid ${C(i).accentColor}`})},[w(Y,{"id-spot":t.ch_spot},null,8,["id-spot"]),p("h3",{style:T({color:`${C(i).accentColorSecondary}`})},J(t.ch_name),5),p("div",{ref_key:"chart",ref:f,style:{width:"565px",height:"300px"}},null,512),m.value?(S(),A("div",{key:0,class:U(["chloader",[`${C(i).mTheme}`]])},[u[0]||(u[0]=p("img",{src:"https://i.pinimg.com/originals/cb/17/b8/cb17b80a942d7c317a35ff1324fae12f.gif"},null,-1)),p("div",ee,[p("span",{style:T([{"border-radius":"10px",position:"absolute",top:"0",left:"0",height:"100%",transition:"ease-in-out 1s"},{width:`${r.value}%`,background:`${C(i).accentColor}`}])},null,4)])],2)):q("",!0)],4))}}),oe={class:"col-md-3"},ae={class:"chartcontainer"},he=P({__name:"LineChartFol",setup(G){D().asideToggle(!1);const t=()=>{const r=new Date,l=r.getFullYear(),n=String(r.getMonth()+1).padStart(2,"0"),$=String(r.getDate()).padStart(2,"0");return`${l}-${n}-${$}`},s=d(60),f=d(t()),m=d({1:{spot:"MGS BJG",id:1},2:{spot:"MGS BJG (1)",id:15},3:{spot:"BOOSTER",id:2},4:{spot:"MGS BJG (2)",id:16},5:{spot:"MGS KAS",id:3},6:{spot:"MOS TPN",id:4},7:{spot:"GS 02 SGL",id:5},8:{spot:"GS 02 SGL (02)",id:6},9:{spot:"GS 02 SGL (03)",id:7},10:{spot:"GS 01 KTT",id:8},11:{spot:"MGS TPN",id:9},12:{spot:"0 KM SP BETUNG",id:10},13:{spot:"5.3 KM SIMP. PASAR GAJAH (5.3)",id:11},14:{spot:"9.5 KM SANDTRAP II (4.2)",id:12},15:{spot:"13.8 KM MGS BJG (4.3)",id:13},16:{spot:"MINIATUR (CIP)",id:14}});return(r,l)=>(S(),I(Z,{"context-title":"FOL | Line Chart"},{default:O(()=>[p("div",oe,[w(X,{"in-type":"date","in-label":"Date Filter","model-value":f.value,"onUpdate:modelValue":l[0]||(l[0]=n=>f.value=n)},null,8,["model-value"]),w(Q,{"in-label":"Time split","model-value":s.value,"onUpdate:modelValue":l[1]||(l[1]=n=>s.value=n)},{default:O(()=>l[2]||(l[2]=[p("option",{value:"5"},"5 Minutes",-1),p("option",{value:"15"},"15 Minutes",-1),p("option",{value:"30"},"30 Minutes",-1),p("option",{value:"45"},"45 Minutes",-1),p("option",{value:"60"},"1 Hour",-1)])),_:1},8,["model-value"])]),p("div",ae,[(S(!0),A(j,null,H(Object.keys(m.value),n=>(S(),I(te,{key:n,ch_timesplit:s.value,ch_name:m.value[n].spot,ch_filter_date:f.value,ch_spot:m.value[n].id},null,8,["ch_timesplit","ch_name","ch_filter_date","ch_spot"]))),128))])]),_:1}))}});export{he as default};
