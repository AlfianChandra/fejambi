import{u as D}from"./theme-g-j4RzVu.js";import{i as R}from"./index-CehbAW_K.js";import{d as P,e as m,l as L,j as z,o as g,c as A,a as w,g as p,t as J,h as T,u as b,n as U,m as q,p as E,f as I,w as O,z as j,F as H}from"./index-D1adL8BK.js";import{a as W}from"./axios-BimPEqV4.js";import{_ as Y}from"./BatteryView.vue_vue_type_style_index_0_computed_true_lang-BOWoO67S.js";import{_ as X}from"./InputView.vue_vue_type_style_index_0_lang-2YIYBEL6.js";import{_ as Z}from"./MainWrapperView.vue_vue_type_style_index_0_lang-BkdLZbwd.js";import{_ as Q}from"./SelectView.vue_vue_type_style_index_0_lang-yJLv2oEB.js";import"./moment-C5S46NFB.js";const ee={style:{width:"200px",position:"relative",background:"#eee",height:"5px","border-radius":"10px"}},te=P({__name:"ChartLineView",props:{ch_name:{type:String,required:!0},ch_spot:{type:[Number],required:!0},ch_filter_date:{type:String,required:!0},ch_ymax:{type:Number,default:500},ch_ymin:{type:Number,default:0},ch_timesplit:{type:Number,default:30}},setup(G){const s=D(),t=G,o=m(t.ch_ymax);m(0),t.ch_spot==1||t.ch_spot==2||t.ch_spot==15||t.ch_spot==16?o.value=200:t.ch_spot==3||t.ch_spot==4?o.value=300:t.ch_spot==9?o.value=100:(t.ch_spot==10||t.ch_spot==11||t.ch_spot==12||t.ch_spot==13)&&(o.value=250);const y=m(null),f=m(!0),n=m(0),a=m(null),c=m(!1),$=m([]),x={notMerge:!0,lazyUpdate:!0,tooltip:{trigger:"axis",axisPointer:{type:"cross"}},toolbox:{feature:{dataZoom:{yAxisIndex:"none"},dataView:{readOnly:!1},magicType:{type:["line","bar"]},restore:{},saveAsImage:{},brush:{type:["lineX","clear"]}},iconStyle:{color:`${s.accentColor}`}},axisPointer:{link:{xAxisIndex:"all"},label:{backgroundColor:"#777"}},legend:{textStyle:{color:`${s.accentColor}`}},xAxis:{name:"Time",type:"category",nameLocation:"middle",nameTextStyle:{lineHeight:60},axisLine:{show:!0},splitLine:{show:!0,lineStyle:{color:"#cccccccc"}},axisLabel:{rotate:-45,color:`${s.accentColor}`,formatter:l=>{const u=l.split(":")[0],_=l.split(":")[1];if(_%t.ch_timesplit===0)return`${u}:${_}`}},boundaryGap:!1,axisTick:{alignWithLabel:!0},data:[]},yAxis:{name:"Pressure (PSI)",nameLocation:"middle",min:t.ch_ymin,nameGap:40,max:o.value,splitLine:{lineStyle:{color:"#ccccccaa"}},nameTextStyle:{verticalAlign:"middle"},axisTick:{show:!0},axisLabel:{color:`${s.accentColor}`},type:"value",axisLine:{show:!0}},series:[]};setTimeout(()=>{a.value.setOption(x)},500);const B=l=>new Date(l).toISOString(),M=async()=>{try{const l={id:t.ch_spot+"",date:B(t.ch_filter_date)},u=await W.post(E.baseEnd+"api/Data/getspotdata",l);n.value=80;const _=[];for(let h=0;h<24;h++)for(let d=0;d<60;d++)_.push(`${h<10?"0"+h:h}:${d<10?"0"+d:d}`);$.value=_,n.value=85;const S=u.data.map(h=>parseFloat(h.psiValue).toFixed(2));x.xAxis=[{data:_}],x.series=[{name:"Pressure",data:S,type:"line",itemStyle:{normal:{color:"#06B800",color0:"#FA0000",borderColor:null,borderColor0:null,opacity:0}},endLabel:{show:!0,fontSize:8,color:"#fff",offset:[-5,0],padding:3,borderRadius:3,textBorderWidth:0,backgroundColor:s.accentColorSecondary,formatter:function(h){const d=S;let i=0,r=0,C=0;for(let v=0;v<d.length;v++)d[v]>C&&(C=d[v]);for(let v=0;v<d.length;v++){const e=parseInt(d[v]);(t.ch_spot==1&&e>=128&&e<=150||t.ch_spot==2&&e>=70&&e<=100||t.ch_spot==3&&e>=120&&e<=150||t.ch_spot==4&&e>=16&&e<=38||t.ch_spot==5&&e>=250&&e<=300||t.ch_spot==6&&e>=225&&e<=250||t.ch_spot==7&&e>=50&&e<=100||t.ch_spot==8&&e>=200&&e<=260||t.ch_spot==9&&e>=38&&e<=50||t.ch_spot==10&&e>=10&&e<=56||t.ch_spot==11&&e>=7&&e<=35||t.ch_spot==12&&e>=38&&e<=50||t.ch_spot==13&&e>=3&&e<=30||t.ch_spot==14&&e>=38&&e<=50)&&(i+=e,r++)}const k=h.data,F=C,V=(F-k)/F*100,K=i/r;return`Cur: ${parseFloat(h.data).toFixed(2)}
Avg: ${parseFloat(K).toFixed(2)}
Delt: ${V.toFixed(2)}%`}},lineStyle:{color:"#007BFF",width:2}}],a.value.setOption(x),n.value=99,setTimeout(()=>{f.value=!1,n.value=0},1e3)}catch(l){console.log(l),f.value=!1}c.value=!0},N=()=>new Promise((l,u)=>{const _={toolbox:{iconStyle:{color:`${s.accentColor}`}},legend:{textStyle:{color:`${s.accentColor}`}},xAxis:{axisLabel:{rotate:-45,color:`${s.accentColor}`}},yAxis:{splitLine:{lineStyle:{color:"#cccccc11"}},axisLabel:{color:`${s.accentColor}`}}};try{a.value.setOption(_),l()}catch(S){u(S)}});return L(()=>[a.value,t.ch_filter_date],()=>{f.value=!0,n.value=0,setTimeout(()=>{a.value.setOption({series:[]}),n.value=12,M()},500)}),L(()=>[s.accentColor],async()=>{await N().then(()=>{})}),L(()=>t.ch_timesplit,()=>{const l={xAxis:{axisLabel:{formatter:u=>{console.log(u)}}}};a.value.setOption(l)}),setInterval(()=>{c.value&&M()},15e3),z(()=>{const l=R(y.value);a.value=l}),(l,u)=>(g(),A("div",{class:"chparent",style:T({border:`1px solid ${b(s).accentColor}`})},[w(Y,{"id-spot":t.ch_spot},null,8,["id-spot"]),p("h3",{style:T({color:`${b(s).accentColorSecondary}`})},J(t.ch_name),5),p("div",{ref_key:"chart",ref:y,style:{width:"565px",height:"300px"}},null,512),f.value?(g(),A("div",{key:0,class:U(["chloader",[`${b(s).mTheme}`]])},[u[0]||(u[0]=p("img",{src:"https://i.pinimg.com/originals/cb/17/b8/cb17b80a942d7c317a35ff1324fae12f.gif"},null,-1)),p("div",ee,[p("span",{style:T([{"border-radius":"10px",position:"absolute",top:"0",left:"0",height:"100%",transition:"ease-in-out 1s"},{width:`${n.value}%`,background:`${b(s).accentColor}`}])},null,4)])],2)):q("",!0)],4))}}),oe={class:"col-md-3"},ae={class:"chartcontainer"},he=P({__name:"LineChartFol",setup(G){D().asideToggle(!1);const t=()=>{const n=new Date,a=n.getFullYear(),c=String(n.getMonth()+1).padStart(2,"0"),$=String(n.getDate()).padStart(2,"0");return`${a}-${c}-${$}`},o=m(60),y=m(t()),f=m({1:{spot:"MGS BJG",id:1},2:{spot:"MGS BJG (1)",id:15},3:{spot:"BOOSTER",id:2},4:{spot:"MGS BJG (2)",id:16},5:{spot:"MGS KAS",id:3},6:{spot:"MOS TPN",id:4},7:{spot:"GS 02 SGL",id:5},8:{spot:"GS 02 SGL (02)",id:6},9:{spot:"GS 02 SGL (03)",id:7},10:{spot:"GS 01 KTT",id:8},11:{spot:"MGS TPN",id:9},12:{spot:"0 KM SP BETUNG",id:10},13:{spot:"5.3 KM SIMP. PASAR GAJAH (5.3)",id:11},14:{spot:"9.5 KM SANDTRAP II (4.2)",id:12},15:{spot:"13.8 KM MGS BJG (4.3)",id:13},16:{spot:"MINIATUR (CIP)",id:14}});return(n,a)=>(g(),I(Z,{"context-title":"FOL | Line Chart"},{default:O(()=>[p("div",oe,[w(X,{"in-type":"date","in-label":"Date Filter","model-value":y.value,"onUpdate:modelValue":a[0]||(a[0]=c=>y.value=c)},null,8,["model-value"]),w(Q,{"in-label":"Time split","model-value":o.value,"onUpdate:modelValue":a[1]||(a[1]=c=>o.value=c)},{default:O(()=>a[2]||(a[2]=[p("option",{value:"5"},"5 Minutes",-1),p("option",{value:"15"},"15 Minutes",-1),p("option",{value:"30"},"30 Minutes",-1),p("option",{value:"45"},"45 Minutes",-1),p("option",{value:"60"},"1 Hour",-1)])),_:1},8,["model-value"])]),p("div",ae,[(g(!0),A(H,null,j(Object.keys(f.value),c=>(g(),I(te,{key:c,ch_timesplit:o.value,ch_name:f.value[c].spot,ch_filter_date:y.value,ch_spot:f.value[c].id},null,8,["ch_timesplit","ch_name","ch_filter_date","ch_spot"]))),128))])]),_:1}))}});export{he as default};
