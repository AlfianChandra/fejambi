import{u as mt}from"./theme-C8r50Jpy.js";import{_ as Ft}from"./MainWrapperView.vue_vue_type_style_index_0_lang-CoRefhRf.js";import{_ as Ce}from"./SelectView.vue_vue_type_style_index_0_lang-xfgk3LW9.js";import{_ as he}from"./InputView.vue_vue_type_style_index_0_lang-CnbZe6Fc.js";import{_ as $}from"./ButtonView.vue_vue_type_style_index_0_computed_true_lang-DRC6fVK7.js";import{t as rt}from"./trunk-CuaAdnZJ.js";import{d as qe,e as u,A as Et,j as ut,B as Ie,r as Ue,o as a,c as i,a as r,w as D,f as X,m as S,g as t,t as y,_ as Ze,i as bt,l as U,q as p,n as le,u as f,v as Re,x as je,h as q,F as Y,y as B,C as Nt}from"./index-B9WFO0ym.js";import{a as it}from"./axios-BimPEqV4.js";import{i as yt,u as Rt}from"./http-BnDEURrj.js";import{h as O}from"./moment-C5S46NFB.js";import{a as jt,m as It,_ as Ut,u as qt}from"./HistoryECharts.vue_vue_type_script_setup_true_lang-CAgr49b8.js";const Bt={style:{width:"100%",display:"flex","flex-flow":"column"}},Kt=qe({__name:"PressureDistView",props:{selectedSpot:{type:String,required:!0},data:{type:Object,required:!0},leakPointResult:Object},setup(ye){const G=u(!1),_=ye,A=Et(()=>_.data),E=u(rt().getAllTrunk()),m=u({}),N=u(_.selectedSpot),L=()=>E.value[N.value].trunkLength,k=u(0),V=P=>{k.value=P};return ut(()=>{G.value=!0,m.value=A.value,G.value=!1}),Ie(()=>{G.value=!0,m.value=A.value,G.value=!1}),(P,c)=>{const ie=Ue("center");return a(),i("div",Bt,[r(ie,null,{default:D(()=>[r(he,{"in-label":"Drop Tolerance Value","in-type":"number","model-value":k.value,"onUpdate:modelValue":c[0]||(c[0]=v=>k.value=v),style:{width:"200px"}},null,8,["model-value"])]),_:1}),!G.value&&Object.keys(m.value).length?(a(),X(jt,{key:0,onOnToleranceChanged:V,"chart-data":m.value,"selected-spot":N.value,"trunk-length":L(),"tolerance-value":k.value,"prediction-result":_.leakPointResult},null,8,["chart-data","selected-spot","trunk-length","tolerance-value","prediction-result"])):S("",!0)])}}}),Wt={class:"loading"},Ht={style:{"margin-left":"10px"}},Gt=qe({__name:"LoadingView",props:{message:{type:String,default:"Loading..."}},setup(ye){const G=ye;return(_,A)=>(a(),i("div",Wt,[A[0]||(A[0]=t("img",{src:"https://i.pinimg.com/originals/ee/7a/ce/ee7acee141cf774b5511f8c3cb0e0016.gif",style:{width:"70px",height:"70px","object-fit":"contain"}},null,-1)),t("span",Ht,y(G.message),1)]))}}),Jt=Ze(Gt,[["__scopeId","data-v-c347c2fb"]]),Qt={key:0,class:"datepickdialog"},Xt={class:"datepickinner"},Zt={style:{display:"flex","flex-flow":"row nowrap",gap:"0.2rem"}},el={key:1,class:"selfnavdialog"},tl={class:"selfnavdialog-inner"},ll={style:{display:"flex","flex-flow":"row nowrap","justify-content":"center","margin-bottom":"1rem",gap:"1rem"}},al={style:{display:"flex","flex-flow":"row nowrap",gap:"0.5rem","justify-content":"space-between"}},ol={style:{display:"flex","flex-flow":"row nowrap",gap:"0.3rem"}},sl={style:{display:"flex","flex-flow":"row nowrap",gap:"0.3rem",height:"45px","align-items":"center"}},nl={style:{"border-radius":"10px",display:"flex","flex-flow":"row nowrap","justify-content":"space-between","padding-left":"10px","padding-right":"10px",border:"1px solid #ccc",padding:"20px","margin-bottom":"1rem"}},il={style:{border:"1px solid #ccc",padding:"5px","padding-left":"70px","text-align":"center","padding-right":"70px","border-radius":"100px"}},rl={key:0,style:{"font-size":"11px"}},ul={key:0,style:{"font-size":"11px"}},dl={key:1,style:{"font-size":"11px"}},pl={style:{display:"flex","flex-flow":"row nowrap",width:"100%","align-items":"center","margin-top":"-40px"}},vl={style:{display:"flex","flex-flow":"no wrap",padding:"10px",gap:"0.5rem"}},cl={style:{width:"100%",padding:"10px",position:"relative"}},fl=["max","value"],yl={key:0,class:"sel-wrapper"},ml={style:{display:"flex","justify-content":"flex-start","overflow-x":"auto","white-space":"nowrap",padding:"20px",gap:"1rem",width:"40%"}},bl=["onClick"],gl={key:0,class:"dataspan"},kl={style:{width:"50%"}},hl={style:{color:"#fff",background:"red",width:"70px",padding:"5px","border-radius":"5px","font-size":"10px","text-align":"center"}},wl={style:{width:"60%","padding-right":"5rem","padding-top":"1rem","padding-bottom":"1rem"}},xl=["src"],Dl={class:"table-responsive"},Sl={style:{"margin-top":"1rem"}},Cl={class:"tbl2"},Ml={style:{"margin-top":"1rem"}},$l={class:"tbl2"},_l={key:0,style:{color:"red","text-shadow":"0.5px 0.5px 1px rgba(0,0,0,0.6)"}},Pl={key:1,style:{color:"orange","text-shadow":"0.5px 0.5px 1px rgba(0,0,0,0.6)"}},Ol={key:2,style:{color:"yellow","text-shadow":"0.5px 0.5px 1px rgba(0,0,0,0.6)"}},Yl={key:3,style:{color:"lime","text-shadow":"0.5px 0.5px 1px rgba(0,0,0,0.6)"}},Ll={key:4},Tl={key:2,class:"hmloader"},Al={key:3,class:"model-window"},Vl={class:"modelpick-inner"},zl={key:4,class:"predict-action"},Fl={style:{"margin-bottom":"0.1rem"}},El={style:{"margin-bottom":"0.5rem"}},Nl={style:{display:"flex","flex-flow":"row nowrap",gap:"0.5rem"}},Rl={key:5,class:"leak-window"},jl={style:{color:"rgb(0,150,255)"}},Il={class:"table-responsive"},Ul={style:{width:"100%","margin-top":"1rem"},class:"table table-striped table-hover;"},ql={key:0,style:{border:"1px solid #ccc",padding:"10px"}},Bl={key:1,style:{border:"1px solid #ccc",padding:"10px"}},Kl={style:{"font-weight":"bold",border:"1px solid #ccc",padding:"10px"}},Wl={key:0,style:{"font-weight":"bold",border:"1px solid #ccc",padding:"10px"}},Hl={key:1,style:{"font-weight":"bold",border:"1px solid #ccc",padding:"10px"}},Gl={key:0},Jl=["href"],Ql={style:{"margin-top":"1rem"}},Xl={key:1},Zl={style:{"margin-top":"1rem"}},ea={key:6,class:"setting-window"},ta={class:"setting-inner"},la={class:"pref-block"},aa={key:7,class:"save-window"},oa={class:"save-inner"},sa={style:{display:"flex","flex-flow":"row nowrap",gap:"0.5rem"}},na=qe({__name:"PlaybackViewNew",props:{initDateFilter:{type:String,required:!0},selectedSpot:{type:String,required:!0},initPlaybackDatas:{type:Array,required:!0},snapShots:{type:Object,required:!1,default:null},mainSize:{type:Object,required:!1}},emits:["onDateChange","onDataSave","onLoadPreset","onSnapshotUnloaded"],setup(ye,{emit:G}){const _=qt(),A=rt(),E=G,m=mt(),N=u("forward"),L=u(!1),k=u(""),V=u(!0),P=u(!1),c=ye,ie=u(),v=u(),ve=u(A.getAllTrunk()),F=u(0),me=u(0),Be=u([]),ce=u(!1),be=u(250);let J=null;const ae=u(!1);let re=[],we={};const et=u(),Me=u(""),ue=u(""),Z=u(!0),ee=u(!1),C=u(!1),H=u(!1),xe=u(!1),ge=u(!1),Q=u(7),tt=bt();u(tt.params.saveid);let K=u({}),Pe=null;const oe=u(null),De=u({}),lt=()=>{v.value=yt(ie.value);const o={grid:{top:"10%",left:"10%",right:"10%",bottom:"15%"},legend:{show:!0,type:"scroll",orient:"horizontal"},tooltip:{trigger:"item",triggerOn:"mousemove",axisPointer:{type:"cross",label:{backgroundColor:"#6a7985"}}},axisPointer:{show:!0,type:"shadow"},xAxis:[{type:"category",data:[],boundaryGap:!1,splitNumber:1,minInterval:1,scale:!0,axisLabel:{formatter:function(e){return e.split(" (")[1].split(")")[0]},rotate:45,labelStyle:{fontSize:10}},splitLine:{show:!0,lineStyle:{type:"dashed"}},axisTick:{alignWithLabel:!0}}],yAxis:{type:"value",name:"Pressure (PSI)",nameGap:10,max:600,interval:50,axisTick:{show:!0,inside:!0},splitLine:{show:!0,lineStyle:{type:"solid",color:"#999"}},minorTick:{show:!0},minorSplitLine:{show:!0,lineStyle:{type:"dashed",color:"#ccc"}}},series:[]};v.value.setOption(o),setTimeout(()=>{v.value.dispatchAction({type:"legendInverseSelect"}),v.value.dispatchAction({type:"legendAllSelect"}),v.value.resize()},100)},at=()=>{const o=O().format("YYYY-MM-DD"),e=O(c.initDateFilter).format("YYYY-MM-DD");ae.value=o===e};ut(()=>{window.addEventListener("keyup",ht),at()}),U(()=>ie.value,()=>{lt()});const Se=(o,e)=>{re=[];for(let d of ve.value[c.selectedSpot].spot)we[d.name]=[];c.initPlaybackDatas.slice(0,o+1).forEach((d,h)=>{const I=`${d.dateFilter} (${d.timeRange})`;re.push(I),et.value=I,d.data.forEach(Ee=>{const Je=ve.value[c.selectedSpot].spot.find(Xe=>Xe.id===Ee.idSpot).name,Qe=Ee.avgPsiValues??0;we[Je][h]=Number(Qe.toFixed(2))})});const x=Object.keys(we).map(d=>({name:d,type:"line",data:we[d],showAllSymbol:ge.value,smooth:!1,tooltip:{trigger:"axis",formatter:function(h){return h[0].value}},endLabel:{show:!0,formatter:function(h){return h.value+" ; "+d},color:"#000",backgroundColor:"inherit",padding:5,fontSize:10,borderRadius:5}}));let l=v.value.getOption();l.xAxis[0].data=re,l.series=x,v.value.setOption(l)},b=()=>{v.value.getOption()},n=()=>{C.value=!1,F.value=0,Be.value=[],clearInterval(J),Se(F.value),me.value=F.value/c.initPlaybackDatas.length*100},M=o=>{C.value=!1,Be.value=[],F.value=parseInt(o.target.value,10),Se(F.value),me.value=F.value/c.initPlaybackDatas.length*100};U(()=>c.initDateFilter,async()=>{st(),ot(),await Ye().then(()=>{g()})});const g=()=>{const o=O(c.initDateFilter),e=o.add(1,"days").format("YYYY-MM-DD"),s=o.subtract(2,"days").format("YYYY-MM-DD");Me.value=e,ue.value=s};g();const T=async()=>{st(),await Ye().then(()=>{if(ae.value)m.notifyShowError("End of playback");else{H.value=!0,n();const o=O(Me.value).format("YYYY-MM-DD");ee.value&&(C.value=!0),ce.value=!0,E("onDateChange",o),setTimeout(()=>{H.value=!1},5e3)}})},z=async()=>{st(),await Ye().then(()=>{H.value=!0,n();const o=O(ue.value).format("YYYY-MM-DD");ee.value&&(C.value=!0),ce.value=!0,E("onDateChange",o),setTimeout(()=>{H.value=!1},5e3)})};U(()=>Z.value,()=>{Z.value&&(Te(),L.value=!1,ee.value=!1)}),U(()=>L.value,()=>{L.value?(Z.value=!1,ee.value=!0):Z.value=!0}),U(()=>ee.value,()=>{ee.value&&(Z.value=!1)}),U(()=>C.value,()=>{if(!C.value&&F.value==c.initPlaybackDatas.length)if(Z.value)n(),C.value=!0;else{const o=O().format("YYYY-MM-DD"),e=O(c.initDateFilter).format("YYYY-MM-DD");o===e?C.value=!1:L.value?N.value=="forward"?de.value?c.initDateFilter!=pe.value?T():Ke.value?(n(),E("onDateChange",fe.value)):Te():T():de.value?c.initDateFilter!=fe.value?z():Ke.value?(n(),E("onDateChange",pe.value)):Te():z():(n(),C.value=!0)}W.value&&j.value?(Oe(),R(),b()):te()});const R=()=>{if(C.value)te();else{const o=v.value.getOption();o.series.forEach(s=>{s.symbolSize=Q.value}),o.series.forEach(s=>{s.symbol="circle"});const e=v.value.getOption().tooltip;e.show=!0,v.value.setOption(o)}},te=()=>{const o=v.value.getOption();o.series.forEach(e=>{e.symbolSize=0}),o.series.forEach(e=>{e.symbol="none"}),v.value.setOption(o),v.value.off("click")},w=u({}),Oe=()=>{v.value.off("click"),v.value.on("click",o=>{if(o.componentType==="markLine"){if(o.seriesName==="Normal"){m.notifyConfirm("Delete Normal","Are you sure?","Delete","Cancel",async()=>{dt()},()=>{});return}else m.notifyConfirm("Delete Marker","Delete this marker?","Delete","Cancel",async()=>{const d=v.value.getOption();d.series=d.series.filter((h,I)=>I!==o.seriesIndex),v.value.clear(),v.value.setOption(d),Object.keys(w.value).forEach(h=>{w.value[h].index===o.value&&delete w.value[h]}),V.value=!1,setTimeout(()=>{V.value=!0},100)},()=>{});return}const e=re.findIndex(d=>d===o.name);if(e<0)return;if(w.value.normal){const d=Object.keys(w.value).length,h={type:"line",name:`Drop ${d}`,xAxisIndex:0,data:[],markLine:{symbol:"image://https://gpng.net/wp-content/uploads/ROBBER.png",symbolSize:35,data:[{xAxis:e,symbolRotate:180}],lineStyle:{color:"blue",width:2,type:"dotted"},label:{show:!0,formatter:`Drop ${d}`,position:"insideEndTop"}}},I=v.value.getOption().series;I.push(h),v.value.setOption({series:I})}else{const d={type:"line",name:"Normal",xAxisIndex:0,data:[],markLine:{symbol:"image://https://png.pngtree.com/png-clipart/20230325/original/pngtree-petroleum-workers-or-miners-vector-png-image_9004441.png",symbolSize:42,data:[{xAxis:e}],lineStyle:{color:"red",width:2,type:"dotted"},label:{show:!0,formatter:"Normal",position:"insideEndTop"}}},h=v.value.getOption().series;h.push(d),v.value.setOption({series:h})}const l=v.value.getOption().series.filter(d=>Array.isArray(d.data)).map(d=>({seriesName:d.name,yValue:d.data[e]??0}));if(w.value.normal){const d=Object.keys(w.value).length;w.value[`drop${d}`]={index:e,name:`Drop ${d}`,data:l,order:v.value.getOption().series.length-1,type:"drop",timerange:re[e].split(" (")[1].split(")")[0],seriesName:re[e].split(" (")[1].split(")")[0]+".drop."+c.initDateFilter,date:c.initDateFilter}}else{const d={normal:{index:e,name:"Normal",data:l,order:0,type:"normal",timerange:re[e].split(" (")[1].split(")")[0],seriesName:re[e].split(" (")[1].split(")")[0]+".normal."+c.initDateFilter,date:c.initDateFilter}};w.value={...d,...w.value},oe.value=d.normal.seriesName}})},dt=()=>{const o=v.value.getOption();o.series=o.series.filter(e=>e.name!=="Normal"),v.value.clear(),v.value.setOption(o),delete w.value.normal,m.notifyShow("Normal deleted"),oe.value=null},Ye=()=>new Promise((o,e)=>{try{if(Object.keys(w.value).length===0){o();return}const s=v.value.getOption();s.series=s.series.filter(x=>!x.markLine),v.value.clear(),v.value.setOption(s),w.value={},o()}catch(s){e(s)}});U(()=>[C.value,be.value],()=>{C.value?(J!=null&&clearInterval(J),J=setInterval(()=>{F.value<c.initPlaybackDatas.length?(F.value++,c.initPlaybackDatas[F.value]!=null&&(Se(F.value),me.value=F.value/c.initPlaybackDatas.length*100)):(C.value=!1,clearInterval(J))},be.value)):J&&(clearInterval(J),J=null)}),U(()=>[m.asideVisible],()=>{setTimeout(()=>{v.value.resize()},1e3)});const Le=u(!1),gt=()=>N.value=="forward"?Me.value:ue.value,ke=u(!1),de=u(!1),Ke=u(!0),fe=u(""),pe=u(""),kt=()=>{fe.value?pe.value?(de.value=!0,Z.value=!1,L.value=!0,ee.value=!0,ke.value=!1,C.value=!1):m.notifyShowError("Date 2 is required"):m.notifyShowError("Date 1 is required")};U(()=>ke.value,()=>{ke.value?(C.value=!1,de.value=!1):C.value=!0}),U(()=>[de.value],()=>{de.value&&(n(),N.value=="forward"?E("onDateChange",fe.value):E("onDateChange",pe.value))}),U(()=>N.value,()=>{N.value=="backward"&&(n(),Te())});const Te=()=>{n(),E("onDateChange",c.initDateFilter),de.value=!1,fe.value=null,pe.value=null},ht=o=>{P.value||((o.keyCode==80||o.keyCode==32)&&(C.value=!C.value),o.keyCode==37&&z(),o.keyCode==39&&T())},wt=(o,e)=>{if(o.type=="normal"){m.notifyConfirm("Delete Normal","Are you sure?","Delete","Cancel",async()=>{dt()},()=>{});return}const s=v.value.getOption();s.series=s.series.filter(x=>x.name!==o.name),v.value.clear(),v.value.setOption(s),delete w.value[e],V.value=!1,setTimeout(()=>{V.value=!0},100)},W=u(null),j=u(null),se=u(!1),Ae=u(!1),xt=()=>{Ae.value?(se.value=!1,Ae.value=!1):(W.value=null,j.value=null,se.value=!1)};U(()=>se.value,()=>{Ae.value=!1});const ot=()=>{W.value=null,j.value=null,se.value=!1,te(),m.notifyShow("Prediction stopped"),Ye(),w.value={},K.value={},c.snapShots!=null&&Object.keys(c.snapShots).length>0&&E("onSnapshotUnloaded")};U(()=>[W.value,j.value],()=>{W.value&&j.value?setTimeout(()=>{Oe(),R()},2e3):te()});const Dt=()=>{Ae.value=!0,se.value=!0},Ve=u(!1),pt=u([]),ne=u([]),$e=u(!1),We=u(),St=u(),Ct=()=>{if(!W.value||!j.value){m.notifyShowError("Please select model and method");return}m.notifyShow("Prediction started"),se.value=!1;let o={};Object.keys(w.value).forEach(s=>{if(w.value[s].type!=="normal"||w.value[s].type!=="drop"){const x=A.getAllTrunk()[c.selectedSpot].spot.length;let l={name:w.value[s].name,data:w.value[s].data.map(d=>({avgPsiValues:d.yValue})).slice(0,x),type:w.value[s].type};o[w.value[s].name]=l}}),pt.value=[];const e=_.mlpredict(o,j.value,ve.value[c.selectedSpot].name);if(Ve.value=!0,j.value==="dtree_multi"?setTimeout(()=>{ne.value=e.sort((s,x)=>s.drop-x.drop)},5e3):j.value==="rf_multi"?setTimeout(()=>{ne.value=e.sort((s,x)=>s.drop-x.drop)},5e3):j.value==="rf_single"?setTimeout(()=>{ne.value=e.sort((s,x)=>s.drop-x.drop)},5e3):j.value==="eqlr_single"&&setTimeout(()=>{ne.value=e.sort((s,x)=>s.drop-x.drop)},5e3),ne.value!=null)for(let s=0;s<ne.value.length;s++)ne.value[s].suspectLocation.leak&&pt.value.push(ne.value[s])},vt=u(),ct=u(),Mt=(o,e,s)=>{We.value=o,$e.value=!1,$e.value=!0,vt.value=e,ct.value=s};U(()=>Ve.value,()=>{Ve.value||($e.value=!1,ne.value=null,We.value=null,St.value=null)});const $t=async o=>{k.value=o,await navigator.clipboard.writeText(k.value),m.notifyShow("Coordinate copied to clipboard")},He=o=>{const e=Math.floor(o),s=Math.abs(o-e)*60,x=Math.floor(s),l=(s-x)*60;return`${e}° ${x}' ${l.toFixed(2)}"`};U(()=>ge.value,()=>{if(ge.value){Q.value=5;const o=v.value.getOption();o.series.forEach(e=>{e.showAllSymbol=!0}),o.series.forEach(e=>{e.symbolSize=Q.value}),v.value.setOption(o)}else{Q.value=7;const o=v.value.getOption();o.series.forEach(e=>{e.showAllSymbol=!1}),o.series.forEach(e=>{e.symbolSize=Q.value}),v.value.setOption(o)}}),U(()=>Q.value,()=>{const o=v.value.getOption();o.series.forEach(e=>{e.symbolSize=Q.value}),v.value.setOption(o)});const st=()=>{Q.value=7,ge.value=!1;const o=v.value.getOption();o.series.forEach(e=>{e.symbolSize=Q.value,e.showAllSymbol=!1}),v.value.setOption(o)},_e=u(!1);U(()=>w.value,()=>{K.value={},Object.keys(w.value).forEach(o=>{const e=w.value[o].seriesName,s=w.value[o].data,l=s.map(d=>{const h=A.getAllTrunk()[c.selectedSpot].spot.find(I=>I.name===d.seriesName);if(h!==void 0)return h.id}).filter(d=>d!==void 0);K.value[e]===void 0&&(K.value[e]=[]),l.length>0&&(K.value[e]={date:w.value[o].date,timerange:w.value[o].timerange,type:w.value[o].type,data:l.map((d,h)=>({idSpot:d,avgPsiValues:s[h].yValue}))})})},{deep:!0});const ft=(o,e)=>{const x=K.value[o].data;for(let l=0;l<x.length;l++)if(x[l].idSpot==e)return x[l].avgPsiValues.toFixed(2)};Ie(()=>{var o;if(K.value!=null&&(Pe=Object.keys(K.value),oe.value!=null)){De.value=[];const e=oe.value,s=(o=K.value[e])==null?void 0:o.data;Pe.filter(l=>l!==e).forEach(l=>{const d=K.value[l].data,h=[];ve.value[c.selectedSpot].spot.forEach((I,Ee)=>{const Je=I.id,Qe=s.find(Ne=>Ne.idSpot===Je),Xe=d.find(Ne=>Ne.idSpot===Je);if(Qe&&Xe){const Ne=Qe.avgPsiValues.toFixed(2)-Xe.avgPsiValues.toFixed(2);h[Ee]=Ne}else h[Ee]=0}),De.value.push({dropKey:l,deltas:h})})}});const nt=o=>o.spot,Ge=u(!1),ze=u(""),Fe=u(""),_t=()=>{C.value=!1,Ge.value=!0,P.value=!0},Pt=()=>{Ge.value=!1,P.value=!1},Ot=()=>{if(ze.value==""||Fe.value==""){m.notifyShowError("Name and description are required");return}m.notifyShow("Saving preset. Please wait..."),Ge.value=!1;const o={name:ze.value,desc:Fe.value,selectedModel:W.value,selectedMethod:j.value,selections:w.value,seekerValue:F.value};E("onDataSave",o),ze.value="",Fe.value=""},Yt=()=>{E("onLoadPreset")},Lt=()=>{console.log("Snapshot loaded"),m.notifyShow("Snapshot loaded"),W.value=c.snapShots.selectedModel,j.value=c.snapShots.selectedMethod,setTimeout(()=>{F.value=c.snapShots.seekerValue,setTimeout(()=>{w.value=c.snapShots.selection;const o=v.value.getOption().series;Object.keys(w.value).forEach(s=>{const x=w.value[s];x.type==="normal"?(o.push({type:"line",name:"Normal",xAxisIndex:0,data:[],markLine:{symbol:"image://https://png.pngtree.com/png-clipart/20230325/original/pngtree-petroleum-workers-or-miners-vector-png-image_9004441.png",symbolSize:42,data:[{xAxis:x.index}],lineStyle:{color:"red",width:2,type:"dotted"},label:{show:!0,formatter:"Normal",position:"insideEndTop"}}}),oe.value=x.seriesName):o.push({type:"line",name:x.name,xAxisIndex:0,data:[],markLine:{symbol:"image://https://gpng.net/wp-content/uploads/ROBBER.png",symbolSize:35,data:[{xAxis:x.index,symbolRotate:180}],lineStyle:{color:"blue",width:2,type:"dotted"},label:{show:!0,formatter:x.name,position:"insideEndTop"}}})}),v.value.setOption({series:o});const e=v.value.getOption();v.value.clear(),v.value.setOption(e),R()},1e3),Se(F.value)},3e3)};Ie(()=>{c.snapShots&&Object.keys(c.snapShots).length>0&&Lt()});const Tt=(o,e)=>{let s=!0;return e.forEach(x=>{o<x&&(s=!1)}),s},At=(o,e)=>{let s=0;e.forEach(l=>{s<l&&(s=l)});let x=!0;return e.forEach(l=>{o<l&&l<s&&(x=!1)}),x},Vt=(o,e)=>{let s=0;e.forEach(d=>{s<d&&(s=d)});let x=0;e.forEach(d=>{x<d&&d<s&&(x=d)});let l=!0;return e.forEach(d=>{o<d&&d<x&&(l=!1)}),l},zt=(o,e)=>{let s=!0;return e.forEach(x=>{o>x&&(s=!1)}),s};return Ie(()=>{const o={grid:{top:"10%",left:"10%",right:"10%",bottom:"15%"},legend:{show:!0,type:"scroll",orient:"horizontal"},tooltip:{trigger:"item",triggerOn:"mousemove",axisPointer:{type:"cross",label:{backgroundColor:"#6a7985"}}},axisPointer:{show:!0,type:"shadow"},xAxis:[{type:"category",data:[],boundaryGap:!1,splitNumber:1,minInterval:1,scale:!0,axisLabel:{formatter:function(e){return e.split(" (")[1].split(")")[0]},rotate:45,labelStyle:{fontSize:10}},splitLine:{show:!0,lineStyle:{type:"dashed"}},axisTick:{alignWithLabel:!0}}],yAxis:{type:"value",name:"Pressure (PSI)",nameGap:10,max:600,interval:50,axisTick:{show:!0,inside:!0},splitLine:{show:!0,lineStyle:{type:"solid",color:"#999"}},minorTick:{show:!0},minorSplitLine:{show:!0,lineStyle:{type:"dashed",color:"#ccc"}}},series:[]};c.initPlaybackDatas.length>0&&setTimeout(()=>{we={},v.value.dispose(),v.value=yt(ie.value),setTimeout(()=>{v.value.setOption(o),Se(F.value),ce.value=!1,ee.value&&(C.value=!0)},500)},1e3)}),(o,e)=>{const s=Ue("font-awesome-icon"),x=Ue("center");return a(),i(Y,null,[ke.value?(a(),i("div",Qt,[t("div",Xt,[e[31]||(e[31]=t("h2",null,[t("b",null,"Select Range")],-1)),e[32]||(e[32]=t("p",{style:{padding:"0",margin:"0"}},"Automatically plays the playback based on current setup",-1)),r(Ce,{"in-label":"Speed","model-value":be.value,"onUpdate:modelValue":e[0]||(e[0]=l=>be.value=l)},{default:D(()=>e[28]||(e[28]=[t("option",{value:"1000"},"Slowest",-1),t("option",{value:"500"},"Slower",-1),t("option",{value:"300"},"Moderate",-1),t("option",{value:"250"},"Faster",-1),t("option",{value:"200"},"Fastest",-1)])),_:1},8,["model-value"]),r(he,{"in-type":"date","in-label":"Date 1","model-value":fe.value,"onUpdate:modelValue":e[1]||(e[1]=l=>fe.value=l)},null,8,["model-value"]),r(he,{"in-type":"date","in-label":"Date 2","model-value":pe.value,"onUpdate:modelValue":e[2]||(e[2]=l=>pe.value=l)},null,8,["model-value"]),t("div",Zt,[r($,{onClick:kt,"bt-disabled":!1,style:{width:"fit-content"}},{default:D(()=>e[29]||(e[29]=[p("Apply Filter ")])),_:1}),r($,{onClick:e[3]||(e[3]=l=>ke.value=!ke.value),"bt-disabled":!1,style:{width:"fit-content"}},{default:D(()=>e[30]||(e[30]=[p("Cancel ")])),_:1})])])])):S("",!0),Le.value?(a(),i("div",el,[t("div",tl,[e[35]||(e[35]=t("h2",null,[t("b",null,"Select Preference")],-1)),r(Ce,{"in-label":"Select","model-value":N.value,"onUpdate:modelValue":e[4]||(e[4]=l=>N.value=l)},{default:D(()=>e[33]||(e[33]=[t("option",{value:"forward"},"Forward",-1),t("option",{value:"backward"},"Backward",-1)])),_:1},8,["model-value"]),r($,{onClick:e[5]||(e[5]=l=>Le.value=!Le.value),style:{width:"fit-content"},"bt-disabled":!1},{default:D(()=>[r(s,{icon:"save"}),e[34]||(e[34]=p(" Save & Apply "))]),_:1})])])):S("",!0),e[90]||(e[90]=t("h5",{style:{"text-align":"center"}},[t("b",null,"Playback")],-1)),r(x,null,{default:D(()=>[r(Ce,{style:{width:"400px"},"in-label":"Speed","model-value":be.value,"onUpdate:modelValue":e[6]||(e[6]=l=>be.value=l)},{default:D(()=>e[36]||(e[36]=[t("option",{value:"1000"},"Slowest",-1),t("option",{value:"500"},"Slower",-1),t("option",{value:"300"},"Moderate",-1),t("option",{value:"250"},"Faster",-1),t("option",{value:"200"},"Fastest",-1)])),_:1},8,["model-value"])]),_:1}),t("div",ll,[!C.value&&!j.value&&!W.value?(a(),X($,{key:0,onClick:e[7]||(e[7]=l=>se.value=!se.value),"bt-disabled":!1},{default:D(()=>[r(s,{icon:"atom"}),e[37]||(e[37]=p(" Leak Detection"))]),_:1})):S("",!0),C.value?S("",!0):(a(),X($,{key:1,onClick:Yt,"bt-disabled":!1},{default:D(()=>[r(s,{icon:"download"}),e[38]||(e[38]=p(" Import Snapshot "))]),_:1})),j.value&&W.value?(a(),X($,{key:2,onClick:e[8]||(e[8]=l=>xe.value=!xe.value),"bt-disabled":!1},{default:D(()=>[r(s,{icon:"sliders"}),e[39]||(e[39]=p(" Settings "))]),_:1})):S("",!0),j.value&&W.value?(a(),X($,{key:3,style:{background:"red"},onClick:ot,"bt-disabled":!1},{default:D(()=>[r(s,{icon:"close"}),e[40]||(e[40]=p(" Quit Prediction"))]),_:1})):S("",!0)]),t("div",al,[t("div",ol,[t("label",{class:le([`${f(m).textTheme}`]),style:{cursor:"pointer",padding:"10px",border:"1px solid #ccc","margin-bottom":"1rem","border-radius":"10px"}},[Re(t("input",{"onUpdate:modelValue":e[9]||(e[9]=l=>Z.value=l),type:"checkbox"},null,512),[[je,Z.value]]),e[41]||(e[41]=p(" Auto-replay "))],2),t("label",{class:le([`${f(m).textTheme}`]),style:{cursor:"pointer",padding:"10px",border:"1px solid #ccc","margin-bottom":"1rem","border-radius":"10px"}},[Re(t("input",{"onUpdate:modelValue":e[10]||(e[10]=l=>ee.value=l),type:"checkbox"},null,512),[[je,ee.value]]),e[42]||(e[42]=p(" Autoplay on navigating "))],2),t("label",{class:le([`${f(m).textTheme}`]),style:{cursor:"pointer",padding:"10px",border:"1px solid #ccc","margin-bottom":"1rem","border-radius":"10px"}},[Re(t("input",{"onUpdate:modelValue":e[11]||(e[11]=l=>L.value=l),type:"checkbox"},null,512),[[je,L.value]]),e[43]||(e[43]=p(" Self Navigate "))],2),L.value?(a(),X($,{key:0,onClick:e[12]||(e[12]=l=>Le.value=!Le.value),"bt-disabled":!1,type:"button",class:"slfnavbtn"},{default:D(()=>[r(s,{icon:"sliders"})]),_:1})):S("",!0)]),t("div",sl,[de.value?(a(),i("label",{key:0,class:le([`${f(m).textTheme}`]),style:{border:"1px solid #ccc",padding:"10px","border-radius":"10px"}},[p(y(f(O)(fe.value).format("ddd, DD MMM YY"))+"    ",1),r(s,{icon:N.value=="forward"?"caret-right":"caret-left"},null,8,["icon"]),p("    "+y(f(O)(pe.value).format("ddd, DD MMM YY")),1)],2)):S("",!0),de.value?(a(),i("label",{key:1,class:le([`${f(m).textTheme}`]),style:{cursor:"pointer",padding:"10px",border:"1px solid #ccc","border-radius":"10px"}},[Re(t("input",{"onUpdate:modelValue":e[13]||(e[13]=l=>Ke.value=l),type:"checkbox"},null,512),[[je,Ke.value]]),e[44]||(e[44]=p(" Repeat "))],2)):S("",!0),r($,{onClick:e[14]||(e[14]=l=>ke.value=!ke.value),"bt-disabled":!1,type:"button",class:"slfnavbtn"},{default:D(()=>[r(s,{icon:"calendar"})]),_:1}),fe.value&&pe.value?(a(),X($,{key:2,onClick:Te,"bt-disabled":!1,class:"slfnavbtn"},{default:D(()=>[r(s,{icon:"close"})]),_:1})):S("",!0)])]),t("div",nl,[r($,{"bt-disabled":H.value,onClick:z},{default:D(()=>[r(s,{icon:"backward"}),p("    "+y(f(O)(ue.value).format("ddd, DD MMM YY")),1)]),_:1},8,["bt-disabled"]),t("span",il,[t("b",{style:q({color:`${f(m).accentColor}`})},y(f(O)(c.initDateFilter).format("ddd, DD MMM YY")),5),e[48]||(e[48]=t("br",null,null,-1)),de.value?(a(),i("span",{key:0,class:le([`${f(m).textTheme}`]),style:{"font-size":"11px"}},[e[45]||(e[45]=p("Stops at: ")),t("b",null,y(f(O)(pe.value).format("ddd, DD MMM YY")),1)],2)):(a(),i(Y,{key:1},[Z.value?(a(),i("span",rl,[e[46]||(e[46]=p("Repeating: ")),t("b",null,y(f(O)(c.initDateFilter).format("ddd,DD MMM YY")),1)])):(a(),i(Y,{key:1},[ae.value?(a(),i("span",dl,"[End of playback  ·  Autoplay stopped]")):(a(),i("span",ul,[e[47]||(e[47]=p("Upcoming: ")),t("b",null,y(f(O)(gt()).format("ddd, DD MMM YY")),1)]))],64))],64))]),r($,{"bt-disabled":ae.value,onClick:T},{default:D(()=>[p(y(f(O)(Me.value).format("ddd, DD MMM YY"))+"    ",1),r(s,{icon:"forward"})]),_:1},8,["bt-disabled"])]),t("div",{style:q([{position:"relative",width:"100%"},{marginBottom:Object.keys(w.value).length>1?"8rem":"0"}])},[t("div",{ref_key:"heatMap",ref:ie,style:{width:"100%",height:"600px"}},null,512),t("div",pl,[t("div",vl,[C.value?S("",!0):(a(),i("button",{key:0,style:{"z-index":"1",position:"relative"},onClick:e[15]||(e[15]=l=>C.value=!C.value),class:"controlbtn",type:"button"},[r(s,{icon:"play"})])),C.value?(a(),i("button",{key:1,style:{"z-index":"1",position:"relative"},onClick:e[16]||(e[16]=l=>C.value=!C.value),class:"controlbtn",type:"button"},[r(s,{icon:"pause"})])):S("",!0)]),t("div",cl,[t("input",{onChange:M,type:"range",min:0,max:c.initPlaybackDatas.length,value:F.value,class:"slider"},null,40,fl)]),t("div",null,[!C.value&&F.value==c.initPlaybackDatas.length?(a(),i("button",{key:0,onClick:n,class:"controlbtn",type:"button"},[r(s,{icon:"undo"})])):S("",!0)])]),Object.keys(w.value).length?(a(),i("div",yl,[t("div",ml,[(a(!0),i(Y,null,B(w.value,(l,d)=>(a(),i("div",{key:d,class:"selection-item",onClick:h=>wt(l,d)},[t("h5",{style:q({color:l.type=="normal"?"red":"blue"})},[t("b",null,y(l.name),1)],4),(a(!0),i(Y,null,B(l.data,h=>(a(),i("div",{key:h.seriesName},[h.seriesName!="Normal"&&!h.seriesName.includes("Drop")?(a(),i("span",gl,[t("span",kl,y(h.seriesName),1),e[49]||(e[49]=p()),t("span",hl,[t("b",null,y(h.yValue)+" PSI",1)])])):S("",!0)]))),128))],8,bl))),128))]),t("div",wl,[e[54]||(e[54]=t("h4",{style:{"text-align":"center"}},[t("b",null,"Pressure Distribution")],-1)),V.value?(a(),X(Kt,{key:0,style:{width:"100%"},data:f(K),"selected-spot":c.selectedSpot},null,8,["data","selected-spot"])):S("",!0),t("img",{src:f(It),alt:"map",style:{width:"100%",height:"600px","border-radius":"10px","object-fit":"contain"}},null,8,xl),t("div",Dl,[t("h5",Sl,[t("b",null,[r(s,{icon:"oil-well"}),e[50]||(e[50]=p(" Selected Pressures"))])]),t("table",Cl,[t("thead",null,[t("tr",{style:{padding:"5px"},class:le([`${f(m).textTheme}`])},[t("th",{style:q({border:`1px solid ${f(m).accentColor}`})},"ACTION",4),t("th",{style:q({border:`1px solid ${f(m).accentColor}`})},"PINNED SERIES ",4),(a(!0),i(Y,null,B(nt(ve.value[c.selectedSpot]),(l,d)=>(a(),i("th",{style:q({border:`1px solid ${f(m).accentColor}`}),key:d},y(l.name),5))),128))],2)]),t("tbody",null,[(a(!0),i(Y,null,B(f(Pe),(l,d)=>(a(),i("tr",{key:d},[t("td",{style:q({border:`1px solid ${f(m).accentColor}`,position:"relative",textTransform:"uppercase",fontWeight:"bold"})},null,4),t("td",{class:le([`${f(m).textTheme}`]),style:q({border:`1px solid ${f(m).accentColor}`,position:"relative",textTransform:"uppercase",fontWeight:"bold"})},[p(y(f(K)[l].date),1),e[51]||(e[51]=t("br",null,null,-1)),p(" "+y(f(K)[l].timerange),1),e[52]||(e[52]=t("br",null,null,-1)),p(" "+y(f(K)[l].type),1)],6),(a(!0),i(Y,null,B(nt(ve.value[c.selectedSpot]),(h,I)=>(a(),i("td",{style:q({border:`1px solid ${f(m).accentColor}`}),class:le([`${f(m).textTheme}`]),key:I},[ft(l,h.id)?(a(),i(Y,{key:0},[p(y(ft(l,h.id)),1)],64)):(a(),i(Y,{key:1},[p("0.00")],64))],6))),128))]))),128))])]),t("h5",Ml,[t("b",null,[r(s,{icon:"turn-down"}),e[53]||(e[53]=p(" Delta"))])]),t("table",$l,[t("thead",null,[t("tr",{style:{padding:"5px"},class:le([`${f(m).textTheme}`])},[t("th",{style:q({border:`1px solid ${f(m).accentColor}`})},"DROPS",4),t("th",{style:q({border:`1px solid ${f(m).accentColor}`})},"PINNED SERIES ",4),(a(!0),i(Y,null,B(nt(ve.value[c.selectedSpot]),(l,d)=>(a(),i("th",{style:q({border:`1px solid ${f(m).accentColor}`}),key:d},y(l.name),5))),128))],2)]),t("tbody",null,[(a(!0),i(Y,null,B(De.value,(l,d)=>(a(),i("tr",{key:d},[t("td",{style:q({border:`1px solid ${f(m).accentColor}`})},y(d+1),5),t("td",{style:q({border:`1px solid ${f(m).accentColor}`})},y(l.dropKey.split(".")[0]+"."+l.dropKey.split(".")[1]+"."+l.dropKey.split(".")[2]),5),(a(!0),i(Y,null,B(l.deltas,(h,I)=>(a(),i("td",{key:I,style:q({border:`1px solid ${f(m).accentColor}`})},[Tt(h,l.deltas)?(a(),i("span",_l,y(h.toFixed(2)),1)):At(h,l.deltas)?(a(),i("span",Pl,y(h.toFixed(2)),1)):Vt(h,l.deltas)?(a(),i("span",Ol,y(h.toFixed(2)),1)):zt(h,l.deltas)?(a(),i("span",Yl,y(h.toFixed(2)),1)):(a(),i("span",Ll,y(h.toFixed(2)),1))],4))),128))]))),128))])])])])])):S("",!0)],4),ce.value?(a(),i("div",Tl,e[55]||(e[55]=[t("img",{src:"https://cdn.dribbble.com/users/1138184/screenshots/3796132/oil.gif"},null,-1)]))):S("",!0),se.value?(a(),i("div",Al,[t("div",Vl,[t("button",{onClick:xt,class:"modelpick-dismiss"},[r(s,{icon:"times"})]),e[58]||(e[58]=t("h2",null,[t("b",null,"Leak Detection")],-1)),r(Ce,{"in-label":"Select Model","model-value":W.value,"onUpdate:modelValue":e[17]||(e[17]=l=>W.value=l)},{default:D(()=>e[56]||(e[56]=[t("option",{value:""},"Select...",-1),t("option",{value:"normal_pick"},"Normal Pick",-1),t("option",{value:"ranged_pick"},"Ranged Pick",-1)])),_:1},8,["model-value"]),r(Ce,{"in-label":"Select Prediction Method","model-value":j.value,"onUpdate:modelValue":e[18]||(e[18]=l=>j.value=l)},{default:D(()=>e[57]||(e[57]=[t("option",{value:""},"Select method...",-1),t("option",{value:"rf_multi"},"RF Multi-leak",-1),t("option",{value:"dtree_multi"},"DTree Multi-leak",-1)])),_:1},8,["model-value"]),r($,{onClick:e[19]||(e[19]=l=>se.value=!se.value),style:{width:"fit-content","margin-top":"0.5rem"},"bt-disabled":!1},{default:D(()=>[p(y(Ae.value?"Update Preference":"Start Picking"),1)]),_:1})])])):S("",!0),Object.keys(w.value).length>1&&!_e.value&&W.value?(a(),i("div",zl,[t("button",{type:"button",class:"predict-action-hide",onClick:e[20]||(e[20]=l=>_e.value=!_e.value)},[r(s,{icon:"eye-slash"})]),t("div",Fl,[e[59]||(e[59]=p("Picking Model: ")),t("b",null,y(W.value.split("_").map(l=>l.charAt(0).toUpperCase()+l.slice(1)).join("")),1),e[60]||(e[60]=p(" ··· Prediction Method: ")),t("b",null,y(j.value.split("_").map(l=>l.charAt(0).toUpperCase()+l.slice(1)).join(" ")),1)]),t("div",El,[e[61]||(e[61]=p("Num of drops: ")),t("b",null,y(Object.keys(w.value).filter(l=>w.value[l].type=="drop").length),1)]),t("div",Nl,[r($,{"bt-size":"small",onClick:Ct,"bt-disabled":!1,style:{width:"fit-content"}},{default:D(()=>[r(s,{icon:"check"}),e[62]||(e[62]=p(" Predict "))]),_:1}),r($,{"bt-size":"small",onClick:_t,"bt-disabled":!1,style:{width:"fit-content",background:"rgb(0,150,255)"}},{default:D(()=>[r(s,{icon:"plus"}),e[63]||(e[63]=p(" Create Snapshot "))]),_:1}),r($,{"bt-size":"small",onClick:Dt,"bt-disabled":!1,style:{width:"fit-content",background:"#666"}},{default:D(()=>[r(s,{icon:"refresh"}),e[64]||(e[64]=p(" Change Method "))]),_:1}),r($,{"bt-size":"small",onClick:Ye,"bt-disabled":!1,style:{width:"fit-content",background:"orange"}},{default:D(()=>[r(s,{icon:"trash"}),e[65]||(e[65]=p(" Clear Selection "))]),_:1}),r($,{"bt-size":"small",onClick:ot,"bt-disabled":!1,style:{width:"fit-content",background:"red"}},{default:D(()=>[r(s,{icon:"close"}),e[66]||(e[66]=p(" Quit Prediction "))]),_:1})])])):S("",!0),Ve.value?(a(),i("div",Rl,[t("div",{class:le(["leak-body",[`${f(m).mTheme}`]])},[t("button",{type:"button",onClick:e[21]||(e[21]=l=>Ve.value=!1),class:"leak-dismiss"},[r(s,{icon:"times"})]),t("div",{class:"l-left",style:q({width:$e.value?"40%":"100%"})},[e[79]||(e[79]=t("h4",{style:{"font-weight":"bold"}},"Leak Analysis",-1)),e[80]||(e[80]=t("hr",null,null,-1)),ne.value?(a(!0),i(Y,{key:0},B(ne.value,(l,d)=>(a(),i("div",{class:"analysis-set",key:d},[l!=!1?(a(),i(Y,{key:0},[t("h4",jl,[t("b",null," DROP "+y(l.drop),1)]),t("p",null,[e[77]||(e[77]=p(" Result: ")),l!=!1&&l.suspectLocation.leak?(a(),i(Y,{key:0},[e[75]||(e[75]=t("b",{style:{color:"red"}},"Possible leak detected!",-1)),t("div",Il,[t("table",Ul,[t("tr",null,[e[67]||(e[67]=t("th",{style:{border:"1px solid #ccc",padding:"10px"}}," Estimated Leak Point",-1)),l.suspectLocation.leakData.pu_location?(a(),i("th",ql," PU ")):S("",!0),l.suspectLocation.leakData.coordinate?(a(),i("th",Bl," Coordinate ")):S("",!0)]),t("tbody",null,[t("tr",null,[t("td",Kl,y(l.suspectLocation.leakData.leak_point)+" KM ",1),l.suspectLocation.leakData.pu_location?(a(),i("td",Wl," KM "+y(l.suspectLocation.leakData.pu_location),1)):S("",!0),l.suspectLocation.leakData.coordinate?(a(),i("td",Hl,[e[69]||(e[69]=p(" LatLng: ")),t("code",null,y(l.suspectLocation.leakData.coordinate.latitude+", "+l.suspectLocation.leakData.coordinate.longitude),1),e[70]||(e[70]=t("br",null,null,-1)),e[71]||(e[71]=p(" DMS: ")),t("code",null,y(`${He(l.suspectLocation.leakData.coordinate.latitude)}, ${He(l.suspectLocation.leakData.coordinate.longitude)}`),1),e[72]||(e[72]=t("br",null,null,-1)),r($,{onClick:h=>$t(`LATLNG: ${l.suspectLocation.leakData.coordinate.latitude}, ${l.suspectLocation.leakData.coordinate.longitude}
DMS: ${He(l.suspectLocation.leakData.coordinate.latitude)}, ${He(l.suspectLocation.leakData.coordinate.longitude)}`),style:{"margin-top":"5px"},"bt-disabled":!1,"bt-size":"small"},{default:D(()=>[r(s,{icon:"copy"}),e[68]||(e[68]=p(" Copy Coord "))]),_:2},1032,["onClick"])])):S("",!0)])])])]),l.suspectLocation.leakData.coordinate?S("",!0):(a(),i("p",Gl,[r(s,{icon:"info-circle"}),e[73]||(e[73]=p(" Map view and PU Location data is currently not supported for this line "))])),r($,{onClick:h=>Mt(l.suspectLocation.leakData.coordinate,l.suspectLocation.leakData.leak_point,l.suspectLocation.leakData.pu_location),"bt-disabled":!l.suspectLocation.leakData.coordinate},{default:D(()=>[r(s,{icon:"map-marker"}),e[74]||(e[74]=p(" Pinpoint on Map "))]),_:2},1032,["onClick","bt-disabled"]),l.suspectLocation.leakData.coordinate?(a(),i("a",{key:1,class:"gmaps",target:"_blank",href:`https://www.google.com/maps?q=${l.suspectLocation.leakData.coordinate.latitude},${l.suspectLocation.leakData.coordinate.longitude}`,style:{"margin-left":"0.5rem"}},"Google Maps",8,Jl)):S("",!0)],64)):(a(),i(Y,{key:1},[e[76]||(e[76]=t("b",{style:{color:"#555"}},"No leak detected",-1)),t("ol",Ql,[(a(!0),i(Y,null,B(l.suspectLocation.probabilities,(h,I)=>(a(),i("li",{key:I},y(h),1))),128))])],64))])],64)):(a(),i("h6",Xl,[t("b",null,"Analysis on Dataset "+y(d+1),1),e[78]||(e[78]=t("b",{style:{color:"#555"}},"Tidak ada indikasi",-1)),t("ol",Zl,[(a(!0),i(Y,null,B(l.suspectLocation.probabilities,(h,I)=>(a(),i("li",{key:I},y(h),1))),128))])]))]))),128)):(a(),X(Jt,{key:1,message:"Calculating leak probabilities..."}))],4),$e.value?(a(),i("div",{key:0,class:"l-right",style:q({width:$e.value?"60%":"100%",position:"relative"})},[e[81]||(e[81]=t("h4",{style:{"font-weight":"bold"}},"Map View",-1)),e[82]||(e[82]=t("hr",null,null,-1)),r(Ut,{latitude:We.value.latitude,longitude:We.value.longitude,"leak-point":vt.value,"pu-location":ct.value},null,8,["latitude","longitude","leak-point","pu-location"])],4)):S("",!0)],2)])):S("",!0),xe.value?(a(),i("div",ea,[t("div",ta,[e[85]||(e[85]=t("h5",null,[t("b",null,"Prediction Mode Preferences")],-1)),e[86]||(e[86]=t("hr",null,null,-1)),r(he,{"in-label":"Dot Symbol Size","model-value":Q.value,"onUpdate:modelValue":e[22]||(e[22]=l=>Q.value=l),"in-type":"number"},null,8,["model-value"]),t("label",la,[Re(t("input",{type:"checkbox","onUpdate:modelValue":e[23]||(e[23]=l=>ge.value=l)},null,512),[[je,ge.value]]),e[83]||(e[83]=t("div",{style:{display:"flex","flex-flow":"column","margin-left":"0.7rem"}},[t("span",{style:{"font-size":"13px"}},[t("b",null,"Show all dots")]),t("span",{style:{"font-size":"11px"}},"Show all dots or reduce the dot placement")],-1))]),r($,{onClick:e[24]||(e[24]=l=>xe.value=!xe.value),style:{width:"fit-content"},"bt-disabled":!1},{default:D(()=>e[84]||(e[84]=[p(" Save Preferences")])),_:1})])])):S("",!0),Ge.value?(a(),i("div",aa,[t("div",oa,[e[89]||(e[89]=t("h2",null,[t("b",null,"Snapshot")],-1)),r(he,{"in-label":"Name","model-value":ze.value,"onUpdate:modelValue":e[25]||(e[25]=l=>ze.value=l),"in-type":"text"},null,8,["model-value"]),r(he,{"in-label":"Description","model-value":Fe.value,"onUpdate:modelValue":e[26]||(e[26]=l=>Fe.value=l),"in-type":"text"},null,8,["model-value"]),t("div",sa,[r($,{onClick:Ot,style:{width:"fit-content"},"bt-disabled":!1},{default:D(()=>[r(s,{icon:"save"}),e[87]||(e[87]=p(" Create "))]),_:1}),r($,{onClick:Pt,style:{width:"fit-content"},"bt-disabled":!1},{default:D(()=>e[88]||(e[88]=[p("Cancel ")])),_:1})])])])):S("",!0),_e.value?(a(),i("button",{key:8,type:"button",onClick:e[27]||(e[27]=l=>_e.value=!_e.value),class:"predict-action-show"},[r(s,{icon:"eye"})])):S("",!0)],64)}}}),ia=Ze(na,[["__scopeId","data-v-2b28b7cc"]]),ra={class:"dateselect-window"},ua={class:"dateselect-inner"},da={class:"calendar-navigation"},pa={style:{"font-size":"19px"}},va={class:"calendar-days"},ca=["onClick"],fa={key:0,style:{color:"orange","font-weight":"bold"}},ya={key:1},ma={style:{"margin-top":"1rem",display:"flex","flex-flow":"row nowrap","justify-content":"space-between"}},ba={style:{display:"flex","flex-flow":"row nowrap",gap:"0.3rem"}},ga=qe({__name:"DateSelectView",props:{calendarTitle:{type:String,default:"Select Dates"},initialDates:{type:Array,default:()=>[]}},emits:["onApply","onClose"],setup(ye,{emit:G}){const _=u(O().format("YYYY-MM-DD")),A=u([]),E=G,m=ye;U(()=>A.value,L=>{A.value=L.sort((k,V)=>new Date(k).getTime()-new Date(V).getTime())},{deep:!0});const N=()=>{E("onApply",A.value)};return Ie(()=>{m.initialDates.length&&(A.value=m.initialDates)}),(L,k)=>{const V=Ue("font-awesome-icon");return a(),i("div",ra,[t("div",ua,[t("h4",null,[t("b",null,[r(V,{icon:"calendar"}),p(" "+y(m.calendarTitle),1)])]),k[7]||(k[7]=t("hr",null,null,-1)),t("div",da,[t("button",{class:"navmonth-btn",onClick:k[0]||(k[0]=P=>_.value=f(O)(_.value).subtract(1,"month").format("YYYY-MM-DD"))},[r(V,{icon:"angle-left"}),p(" "+y(f(O)(_.value).subtract(1,"month").format("MMMM")),1)]),t("h3",pa,[t("b",null,y(f(O)(_.value).format("MMMM YYYY")),1)]),t("button",{class:"navmonth-btn",onClick:k[1]||(k[1]=P=>_.value=f(O)(_.value).add(1,"month").format("YYYY-MM-DD"))},[p(y(f(O)(_.value).add(1,"month").format("MMMM"))+" ",1),r(V,{icon:"angle-right"})])]),k[8]||(k[8]=Nt('<div class="calendar-days" data-v-8f792f31><div class="calendar-day-week" data-v-8f792f31>Sen</div><div class="calendar-day-week" data-v-8f792f31>Sel</div><div class="calendar-day-week" data-v-8f792f31>Rab</div><div class="calendar-day-week" data-v-8f792f31>Kam</div><div class="calendar-day-week" data-v-8f792f31>Jum</div><div class="calendar-day-week" data-v-8f792f31>Sab</div><div class="calendar-day-week" data-v-8f792f31>Min</div></div>',1)),t("div",va,[(a(!0),i(Y,null,B(f(O)(_.value).startOf("month").day(),P=>(a(),i("div",{key:P,class:"calendar-day-unclickable"}))),128)),(a(!0),i(Y,null,B(f(O)(_.value).daysInMonth(),P=>(a(),i("div",{key:P,class:"calendar-day",onClick:c=>A.value.includes(f(O)(_.value).date(P).format("YYYY-MM-DD"))?A.value.splice(A.value.indexOf(f(O)(_.value).date(P).format("YYYY-MM-DD")),1):A.value.push(f(O)(_.value).date(P).format("YYYY-MM-DD")),style:q({background:A.value.includes(f(O)(_.value).date(P).format("YYYY-MM-DD"))?"#aaaaaa":"#f0f0f0"})},[f(O)(_.value).date(P).format("YYYY-MM-DD")==f(O)().format("YYYY-MM-DD")?(a(),i("span",fa,y(P),1)):(a(),i("span",ya,y(P),1))],12,ca))),128)),(a(!0),i(Y,null,B(6-f(O)(_.value).endOf("month").day(),P=>(a(),i("div",{key:P,class:"calendar-day-unclickable"}))),128))]),t("div",ma,[r($,{onClick:N,"bt-disabled":!A.value.length},{default:D(()=>k[4]||(k[4]=[p("Apply Selections")])),_:1},8,["bt-disabled"]),t("div",ba,[A.value.length?(a(),X($,{key:0,style:{background:"red"},onClick:k[2]||(k[2]=P=>A.value=[]),"bt-disabled":!1},{default:D(()=>[r(V,{icon:"trash"}),k[5]||(k[5]=p(" Clear"))]),_:1})):S("",!0),r($,{onClick:k[3]||(k[3]=P=>E("onClose")),"bt-disabled":!1},{default:D(()=>[r(V,{icon:"times"}),k[6]||(k[6]=p(" Close"))]),_:1})])])])])}}}),ka=Ze(ga,[["__scopeId","data-v-8f792f31"]]),ha={class:"row"},wa={class:"col-md-3"},xa=["value"],Da={style:{display:"flex","flex-flow":"row nowrap","align-items":"center",gap:"1rem"}},Sa={style:{display:"flex","flex-flow":"row nowrap",gap:"1rem","align-items":"center"}},Ca={class:"col-md-12",style:{position:"relative"}},Ma={key:0,class:"loaders"},$a={key:0,class:"load-window"},_a={class:"load-inner"},Pa={style:{display:"flex","flex-flow":"column","align-items":"flex-start",gap:"0.2rem"}},Oa={style:{margin:"0",padding:"0"}},Ya={style:{"font-size":"9px",color:"red"}},La={style:{"font-size":"11px","margin-bottom":"1rem"}},Ta={style:{display:"flex","flex-flow":"row wrap","font-size":"11px",gap:"0.2rem",border:"1px solid #ccc",width:"100%",padding:"10px","border-radius":"10px"}},Aa={style:{color:"#555",padding:"5px",background:"#ddd","border-radius":"5px"}},Va={style:{display:"flex","flex-flow":"row wrap","font-size":"11px",gap:"0.2rem",border:"1px solid #ccc",width:"100%",padding:"10px","border-radius":"10px"}},za={style:{color:"#555",padding:"10px",background:"#eee","border-radius":"5px","text-align":"center"}},Fa={style:{display:"flex","flex-flow":"row wrap","font-size":"12px",background:"#eee",padding:"10px","border-radius":"10px",border:"1px solid #ccc",width:"100%"}},Ea={style:{"margin-right":"10px","font-weight":"bold"}},Na={style:{"font-weight":"bold"}},Ra={style:{"font-weight":"bold"}},ja={style:{"font-weight":"bold"}},Ia={style:{display:"flex","flex-flow":"row nowrap",gap:"0.3rem"}},Ua={key:1,style:{display:"flex","flex-flow":"column","align-items":"center","justify-content":"center",gap:"1rem"}},qa={style:{"font-size":"30px"}},Ba=qe({__name:"PlaybackFol",setup(ye){const G=rt(),_=mt();_.asideToggle(!1);const A=u(G.getAllTrunk()),E=u("trunk1"),m=u();m.value=Object.keys(A.value);const N=u(5),L=u(),k=u([]),V=u(0),P=u([]),c=u(!1),ie=u(!1),v=u(!1),ve=u(!1),F=u(!0),me=u(null),Be=bt(),ce=()=>{V.value++,k.value.push(null)};ut(()=>{const b=Be.params.saveid;b?setTimeout(async()=>{const n="https://rtunode.findingoillosses.com/api/v1/getpresetbyid",M={key:b},g=await it.post(n,M,{headers:{"Content-Type":"application/json",Authorization:`Bearer ${localStorage.getItem("authToken")}`}}),T=g.data.status,z=g.data.data;if(T===200){const R=z;P.value=[],k.value=[];const te=R.dates;V.value=0,N.value=R.timerange,L.value=te[0];for(let w=1;w<te.length;w++)ce();setTimeout(()=>{document.querySelectorAll('input[type="date"]').forEach((w,Oe)=>{w.value=te[Oe],k.value[Oe]=w}),ae(),me.value={name:R.name,desc:R.desc,selectedMethod:R.selectedMethod,selectedModel:R.selectedModel,selection:R.selections,seekerValue:R.seekerValue},ie.value=!0},100)}else _.notifyShowError("Failed fetching snapshot!")},1e3):(be(),ie.value=!0)}),U(()=>[L.value,N.value,E.value],async()=>{ve.value=!1,v.value=!0,await ae()});const be=()=>{const b=new Date,n=b.getFullYear(),M=String(b.getMonth()+1).padStart(2,"0"),g=String(b.getDate()).padStart(2,"0"),T=`${n}-${M}-${g}`;L.value=T},J=async b=>new Promise(async(n,M)=>{try{const g=A.value[E.value];let T=[];for(let te=0;te<g.spot.length;te++)T.push(g.spot[te].id);const z={datefilter:b,timeFilter:N.value,idFilter:T},R=await Rt().httpPost("api/History/getsplittedhistdata",z);n(R)}catch(g){M(g)}}),ae=async()=>{try{c.value=!0;let n=[...await J(L.value)];if(k.value.length>0){for(let M=0;M<k.value.length;M++){const g=k.value[M];if(g!==null){if(g.value!==L.value){const T=await J(g.value);n=n.concat(T)}}else console.log("Null")}v.value=!1}P.value=n,c.value=!1}catch(b){console.log(b),v.value=!1,c.value=!1}},re=async()=>new Promise(async(b,n)=>{try{c.value=!0;let g=[...await J(L.value)];if(k.value.length>0){for(let T=0;T<k.value.length;T++){const z=k.value[T];if(z!==null){if(z.value!==L.value){const R=await J(z.value);g=g.concat(R)}}else console.log("Null")}v.value=!1}P.value=g,c.value=!1,b(!0)}catch(M){console.log(M),v.value=!1,c.value=!1,n(!1)}}),we=(b,n)=>{k.value[n]=b,ae()},et=()=>{V.value>0&&(V.value--,k.value.pop()),ae()},Me=b=>{L.value=b},ue=u([]),Z=async b=>{ee();const n={};n.name=b.name,n.desc=b.desc,n.timerange=N.value,n.selectedModel=b.selectedModel,n.selectedMethod=b.selectedMethod,n.dates=ue.value,n.selections=b.selections,n.seekerValue=b.seekerValue,n.context="jmbfol",(await it.post("https://rtunode.findingoillosses.com/api/v1/savepreset",n,{headers:{"Content-Type":"application/json",Authorization:`Bearer ${localStorage.getItem("authToken")}`}})).data.status===200?(_.notifyShow("Preset has been saved!"),ue.value=[]):(_.notifyShowError("Failed saving preset!"),ue.value=[])},ee=()=>{if(ue.value.push(L.value),k.value.length)for(let b in k.value)ue.value.push(k.value[b].value)},C=u([]),H=u(!1),xe=()=>{H.value=!0,ge()},ge=async()=>{const b={context:"jmbfol"},n=await it.post("https://rtunode.findingoillosses.com/api/v1/getpresets",b,{headers:{"Content-Type":"application/json",Authorization:`Bearer ${localStorage.getItem("authToken")}`}});n.data.status===200?C.value=n.data.data:_.notifyShowError("Failed fetching snapshots!")},Q=async b=>{F.value=!1,P.value=null,k.value=[];const n=b.dates;V.value=0,N.value=b.timerange,L.value=n[0];for(let M=1;M<n.length;M++)ce();tt(n).then(async()=>{await re().then(()=>{me.value={name:b.name,desc:b.desc,selectedMethod:b.selectedMethod,selectedModel:b.selectedModel,selection:b.selections,seekerValue:b.seekerValue},H.value=!1,setTimeout(()=>{F.value=!0},1e3)})})},tt=b=>new Promise((n,M)=>{try{setTimeout(()=>{document.querySelectorAll('input[type="date"]').forEach((g,T)=>{g.value=b[T],k.value[T]=g}),n(!0)},50)}catch(g){M(g)}}),K=b=>{const n=`https://rantau.findingoillosses.com/fol/playback/${b.key}`;navigator.clipboard.writeText(n).then(()=>{_.notifyShow(`${b.name} -> Link copied. CTRL+V to paste`)}),H.value=!1},Pe=()=>{me.value=null},oe=u(!1),De=u([]),lt=b=>{De.value=b,oe.value=!1,L.value=b[0],k.value=[],V.value=0;for(let n=1;n<b.length;n++)ce();setTimeout(()=>{document.querySelectorAll('input[type="date"]').forEach((n,M)=>{n.value=b[M],k.value[M]=n}),ae()},100)},at=()=>{k.value=[],De.value=[],V.value=0,ae()},Se=()=>{oe.value=!1};return(b,n)=>{const M=Ue("font-awesome-icon");return a(),i(Y,null,[r(Ft,{"context-title":"Data Playback"},{default:D(()=>[t("div",ha,[t("div",wa,[n[9]||(n[9]=t("h4",null,[t("b",null,"Filter")],-1)),r(Ce,{"in-label":"Select Line","model-value":E.value,"onUpdate:modelValue":n[0]||(n[0]=g=>E.value=g)},{default:D(()=>[(a(!0),i(Y,null,B(m.value,(g,T)=>(a(),i("option",{key:T,value:g},y(A.value[g].name),9,xa))),128))]),_:1},8,["model-value"]),r(Ce,{"in-label":"Time Range","model-value":N.value,"onUpdate:modelValue":n[1]||(n[1]=g=>N.value=g)},{default:D(()=>n[6]||(n[6]=[t("option",{value:"1"},"1 Minute",-1),t("option",{value:"2"},"2 Minutes",-1),t("option",{value:"3"},"3 Minutes",-1),t("option",{value:"4"},"4 Minutes",-1),t("option",{value:"5"},"5 Minutes",-1),t("option",{value:"10"},"10 Minutes",-1),t("option",{value:"15"},"15 Minutes",-1),t("option",{value:"30"},"30 Minutes",-1),t("option",{value:"60"},"60 Minutes",-1)])),_:1},8,["model-value"]),t("div",Da,[r(he,{"in-type":"date","in-label":"Date Filter","model-value":L.value,"onUpdate:modelValue":n[2]||(n[2]=g=>L.value=g),style:{width:"100%"}},null,8,["model-value"])]),t("div",Sa,[r($,{onClick:et,"bt-size":"small","bt-type":"button","bt-disabled":!1},{default:D(()=>[r(M,{icon:"minus"})]),_:1}),t("span",{class:le([`${f(_).textTheme}`])},y(V.value),3),r($,{onClick:ce,"bt-size":"small","bt-type":"button","bt-disabled":!1},{default:D(()=>[r(M,{icon:"plus"})]),_:1})]),(a(!0),i(Y,null,B(V.value,(g,T)=>(a(),i("div",{key:T,style:{display:"flex","flex-flow":"row nowrap","align-items":"center",gap:"1rem"}},[r(he,{"in-type":"date","in-label":`Date Filter ${g}`,onOnValueChange:z=>we(z,T),style:{width:"100%"}},null,8,["in-label","onOnValueChange"])]))),128)),r($,{"bt-size":"normal","bt-type":"button",onClick:n[3]||(n[3]=g=>oe.value=!oe.value),"bt-disabled":!1,style:{"margin-top":"0.5rem",width:"fit-content"}},{default:D(()=>[r(M,{icon:"calendar"}),n[7]||(n[7]=p(" Select Dates "))]),_:1}),k.value.length>0?(a(),X($,{key:0,"bt-size":"normal","bt-type":"button",onClick:at,"bt-disabled":!1,style:{"margin-top":"0.5rem","margin-left":"5px",width:"fit-content",background:"red"}},{default:D(()=>[r(M,{icon:"trash"}),n[8]||(n[8]=p(" Clear Dates "))]),_:1})):S("",!0)]),t("div",Ca,[c.value&&ie.value?(a(),i("div",Ma,n[10]||(n[10]=[t("img",{src:"https://cdn.dribbble.com/users/1138184/screenshots/3796132/oil.gif",style:{width:"350px",height:"350px","object-fit":"contain","border-radius":"20px"}},null,-1),t("p",{style:{"text-align":"center",margin:"0",padding:"0","margin-top":"-5rem"}},[t("b",null,"FOL Jambi Data Center")],-1)]))):S("",!0),P.value&&F.value?(a(),X(ia,{key:1,"snap-shots":me.value,onOnDataSave:Z,onOnLoadPreset:xe,"init-date-filter":L.value,"selected-spot":E.value,"init-playback-datas":P.value,onOnSnapshotUnloaded:Pe,onOnDateChange:Me},null,8,["snap-shots","init-date-filter","selected-spot","init-playback-datas"])):S("",!0)])])]),_:1}),H.value?(a(),i("div",$a,[t("div",_a,[t("button",{type:"button",class:"load-dismiss",onClick:n[4]||(n[4]=g=>H.value=!H.value)},[r(M,{icon:"times"})]),C.value.length>0?(a(),i(Y,{key:0},[n[16]||(n[16]=t("h2",{style:{"padding-left":"1rem"}},[t("b",null,"Saved Snapshots")],-1)),(a(!0),i(Y,null,B(C.value,(g,T)=>(a(),i("div",{class:"preset-item",key:T},[t("div",Pa,[t("h5",Oa,[t("b",null,[p(y(g.name)+" ",1),t("sup",Ya,[t("b",null,"#"+y(g.key),1)])])]),t("div",La,[n[11]||(n[11]=p("Description: ")),t("b",null,y(g.desc),1)]),t("div",Ta,[(a(!0),i(Y,null,B(g.dates,(z,R)=>(a(),i("div",{key:R,style:{"font-weight":"bold"}},[t("div",Aa,[t("b",null,[r(M,{icon:"calendar"}),p(" "+y(z),1)])])]))),128))]),t("div",Va,[(a(!0),i(Y,null,B(g.selections,(z,R)=>(a(),i("div",{key:R,style:{"font-weight":"bold",width:"150px"}},[t("div",za,[t("b",{style:q({color:`${z.type=="drop"?"red":"green"}`})},y(`${z.name}: (${z.timerange})`),5)])]))),128))]),t("div",Fa,[t("span",Ea,[n[12]||(n[12]=p("Pick: ")),t("code",Na,y(g.selectedModel),1)]),t("span",Ra,[n[13]||(n[13]=p("Prediction: ")),t("code",ja,y(g.selectedMethod),1)])]),t("div",Ia,[r($,{"bt-disabled":!1,"bt-size":"small","bt-type":"button",onClick:z=>Q(g),style:{"margin-top":"1rem"}},{default:D(()=>[r(M,{icon:"plus"}),p(" Import "+y(g.name),1)]),_:2},1032,["onClick"]),r($,{"bt-disabled":!1,"bt-size":"small","bt-type":"button",onClick:z=>K(g),style:{"margin-top":"1rem"}},{default:D(()=>[r(M,{icon:"copy"}),n[14]||(n[14]=p(" Copy Share Link "))]),_:2},1032,["onClick"]),r($,{"bt-disabled":!1,"bt-size":"small","bt-type":"button",onClick:n[5]||(n[5]=z=>H.value=!H.value),style:{"margin-top":"1rem",background:"red"}},{default:D(()=>[r(M,{icon:"trash"}),n[15]||(n[15]=p(" Delete "))]),_:1})])])]))),128))],64)):(a(),i("div",Ua,[t("span",qa,[r(M,{icon:"inbox"})]),n[17]||(n[17]=t("h5",{style:{padding:"0",margin:"0"}},"No Snapshot(s) Found!",-1)),n[18]||(n[18]=t("p",{style:{padding:"0",margin:"0","text-align":"center"}},[p("To add a new Snapshot, select Normal & Drop(s) on active Leak Detection chart and click "),t("b",null,"Create Snapshot")],-1))]))])])):S("",!0),oe.value?(a(),X(ka,{key:1,"initial-dates":De.value,onOnClose:Se,onOnApply:lt},null,8,["initial-dates"])):S("",!0)],64)}}}),ao=Ze(Ba,[["__scopeId","data-v-6e0eae5c"]]);export{ao as default};
